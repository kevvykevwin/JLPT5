<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JLPT N5 Flashcards - Adaptive Learning System (Enhanced)</title>
    <meta name="description" content="Master JLPT N5 vocabulary with spaced repetition, adaptive quizzes, and pronunciation practice. Free Japanese learning tool with 230+ essential words.">
    <meta name="keywords" content="JLPT N5, Japanese vocabulary, flashcards, spaced repetition, kanji practice, Japanese learning">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üáØüáµ</text></svg>">
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#667eea">
    
    <!-- CSS Files -->
    <link rel="stylesheet" href="assets/css/base.css">
    <link rel="stylesheet" href="assets/css/components.css">
    <link rel="stylesheet" href="assets/css/quiz.css">
    <link rel="stylesheet" href="assets/css/stats.css">
    <link rel="stylesheet" href="assets/css/modal.css">
    <link rel="stylesheet" href="assets/css/responsive.css">
    
    <!-- Updated Styles for Learning Info Modal -->
    <style>
        .learning-info-content {
            max-height: 70vh;
            overflow-y: auto;
            padding-right: 10px;
        }

        .learning-info-content h4 {
            color: #2e7d32;
            margin: 20px 0 10px 0;
            font-size: 16px;
        }

        .learning-info-content h4:first-child {
            margin-top: 0;
        }

        .learning-info-content p {
            margin-bottom: 12px;
            line-height: 1.6;
            color: #333;
        }

        .learning-info-content ul {
            margin: 10px 0;
            padding-left: 20px;
        }

        .learning-info-content li {
            margin-bottom: 8px;
            line-height: 1.5;
        }

        .state-indicator-legend {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }

        .state-example {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
        }

        .state-example-indicator {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            color: white;
            font-size: 10px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
        }
    </style>
</head>
<body>
    <div class="flashcard-container">
        <div class="header">
            <div class="menu-container">
                <div class="hamburger-menu" id="hamburgerMenu">
                    <div class="hamburger-icon">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </div>
                <div class="dropdown-menu" id="dropdownMenu">
                    <div class="filter-section">
                        <div class="filter-section-title">Word Types</div>
                        <div class="filter-option" data-filter="all">
                            <div class="toggle-switch">
                                <input type="checkbox" id="filterAll" checked>
                                <span class="toggle-slider"></span>
                            </div>
                            <label for="filterAll">All Words</label>
                            <span class="word-count-badge" id="allCount">0</span>
                        </div>
                        <div class="filter-option" data-filter="noun">
                            <div class="toggle-switch">
                                <input type="checkbox" id="filterNouns">
                                <span class="toggle-slider"></span>
                            </div>
                            <label for="filterNouns">Nouns</label>
                            <span class="word-count-badge" id="nounCount">0</span>
                        </div>
                        <div class="filter-option" data-filter="verb">
                            <div class="toggle-switch">
                                <input type="checkbox" id="filterVerbs">
                                <span class="toggle-slider"></span>
                            </div>
                            <label for="filterVerbs">Verbs</label>
                            <span class="word-count-badge" id="verbCount">0</span>
                        </div>
                        <div class="filter-option" data-filter="i-adjective">
                            <div class="toggle-switch">
                                <input type="checkbox" id="filterIAdj">
                                <span class="toggle-slider"></span>
                            </div>
                            <label for="filterIAdj">„ÅÑ-Adjectives</label>
                            <span class="word-count-badge" id="iAdjCount">0</span>
                        </div>
                        <div class="filter-option" data-filter="na-adjective">
                            <div class="toggle-switch">
                                <input type="checkbox" id="filterNaAdj">
                                <span class="toggle-slider"></span>
                            </div>
                            <label for="filterNaAdj">„Å™-Adjectives</label>
                            <span class="word-count-badge" id="naAdjCount">0</span>
                        </div>
                    </div>
                </div>
            </div>
            <h1>JLPT N5 Adaptive Learning</h1>
            
            <div id="retentionPrompt" class="retention-prompt">
                ‚ú® Some of these help strengthen memory retention (<span id="reviewCount">0</span> reviews mixed in)
            </div>

            <div class="tab-container">
                <button class="tab-button active" data-tab="study">üìö Study</button>
                <button class="tab-button" data-tab="quiz">üß† Quiz</button>
            </div>
            
            <div class="progress">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            
            <div class="card-info">
                <div id="cardCounter">Card 1 of 0</div>
                <div id="cardType">Adaptive</div>
            </div>
        </div>
        
        <div class="tab-content active" id="studyTab">
            <div class="flashcard" id="flashcard" onclick="flipCard()">
                <div class="learning-state-indicator" id="stateIndicator">N</div>
                <button class="audio-button" id="audioButton" onclick="playAudio(event)" title="Listen to pronunciation">
                    üîä
                </button>
                <div class="prompt-text" id="promptText"></div>
                <div class="japanese-word" id="japaneseWord">Loading vocabulary...</div>
                <div class="reading" id="reading">Please wait...</div>
                <div class="meaning" id="meaning" style="display: none;">Loading...</div>
            </div>
        </div>

        <div class="tab-content" id="quizTab">
            <!-- REMOVED: Reading toggle button since kana toggle handles this functionality -->
            <div class="quiz-mode-selector">
                <button class="quiz-mode-btn active" data-mode="multiple-choice">Multiple Choice</button>
                <button class="quiz-mode-btn" data-mode="listening-first">Listening First</button>
                <button class="quiz-mode-btn" data-mode="mixed-challenge">Mixed Challenge</button>
                <button class="quiz-mode-btn" data-mode="speed-challenge">Speed Challenge</button>
                <button class="quiz-mode-btn" data-mode="kanji-only">Kanji Only</button>
            </div>

            <div class="quiz-container active" id="quizContainer">
                <!-- FIXED: Kana toggle positioned in top-left of quiz container -->
                <div class="kana-toggle-container hidden" id="kanaToggleContainer">
                    <div class="kana-toggle-switch">
                        <input type="checkbox" id="kanaToggleInput">
                        <span class="kana-toggle-slider"></span>
                    </div>
                    <label for="kanaToggleInput" id="kanaToggleLabel">Show: Kana</label>
                </div>

                <div class="japanese-word quiz-question" id="quizQuestion">What does this mean?</div>
                <div id="quizAudioSection" class="quiz-audio-section" style="display: none;">
                    <button class="quiz-audio-button" id="quizAudioButton" onclick="playAudio(event)" title="Listen to pronunciation">
                        üîä
                    </button>
                    <div class="quiz-audio-label">Click to listen</div>
                </div>
                <div class="quiz-options" id="quizOptions"></div>
                <div class="quiz-feedback" id="quizFeedback"></div>
            </div>
        </div>
        
        <div class="controls">
            <button class="btn btn-secondary" onclick="previousCard()">‚Üê Previous</button>
            <button class="btn btn-primary" onclick="flipCard()" id="flipBtn">Flip Card</button>
            <button class="btn btn-primary" onclick="nextCard()">Next ‚Üí</button>
        </div>
        
        <div class="controls">
            <button class="btn btn-secondary" onclick="shuffleCards()">üîÄ Shuffle</button>
            <button class="btn btn-secondary" onclick="resetProgress()">üîÑ Reset</button>
            <button class="btn btn-secondary" onclick="toggleStats()">üìä Stats</button>
        </div>
        
        <div class="stats" id="stats">
            <h3>üìà Learning Analytics Dashboard</h3>
            
            <div class="learning-overview">
                <div class="learning-stat new">
                    <span class="learning-stat-number" id="statNew">0</span>
                    <span class="learning-stat-label">New</span>
                </div>
                <div class="learning-stat learning">
                    <span class="learning-stat-number" id="statLearning">0</span>
                    <span class="learning-stat-label">Learning</span>
                </div>
                <div class="learning-stat review">
                    <span class="learning-stat-number" id="statReview">0</span>
                    <span class="learning-stat-label">Review</span>
                </div>
                <div class="learning-stat mastered">
                    <span class="learning-stat-number" id="statMastered">0</span>
                    <span class="learning-stat-label">Mastered</span>
                </div>
            </div>
            
            <div id="detailedStats"></div>
            
            <div class="overall-stats">
                <p><strong>Study Session:</strong> <span id="cardsStudied">0</span> cards studied ‚Ä¢ <span id="timesFlipped">0</span> flips</p>
                <p><strong>Learning Progress:</strong> <span id="progressPercent">0%</span> overall mastery</p>
            </div>
        </div>

        <div class="footer-actions">
            <button class="footer-btn" onclick="showLearningInfo()">‚ùì How Learning Works</button>
            <button class="footer-btn" onclick="showFeedbackForm()">üí¨ Feedback</button>
            <button class="footer-btn donate-btn" onclick="showDonateInfo()">üíù Donate</button>
        </div>
    </div>

    <!-- Feedback Modal -->
    <div class="modal-overlay" id="feedbackModal">
        <div class="modal-content">
            <div class="modal-header">üí¨ Share Your Feedback</div>
            
            <form name="jlpt-feedback" method="POST" data-netlify="true" data-netlify-honeypot="bot-field" onsubmit="submitFeedback(event)">
                <input type="hidden" name="bot-field" />
                <input type="hidden" name="form-name" value="jlpt-feedback" />
                
                <div class="form-group">
                    <label class="form-label">Email (optional)</label>
                    <input type="email" name="email" class="form-input" placeholder="your@email.com">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Your feedback</label>
                    <textarea name="feedback" class="form-textarea" 
                              placeholder="How is the spaced repetition system working for you? Any suggestions for improvement?" 
                              required></textarea>
                </div>
                
                <div class="form-buttons">
                    <button type="submit" class="btn btn-primary" style="margin-right: 10px;">Send Feedback</button>
                    <button type="button" class="btn btn-secondary" onclick="hideFeedbackForm()">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Learning Info Modal -->
    <div class="modal-overlay" id="learningModal">
        <div class="modal-content">
            <div class="modal-header">‚ùì How Learning Works</div>
            
            <div class="learning-info-content">
                <h4>üéØ Adaptive Learning System</h4>
                <p>This app uses <strong>spaced repetition</strong> to optimize your learning. Words you find difficult appear more frequently, while mastered words appear less often.</p>
                
                <h4>üîÑ Learning States</h4>
                <div class="state-indicator-legend">
                    <div class="state-example">
                        <div class="state-example-indicator state-new">N</div>
                        <span>New - First time seeing this word</span>
                    </div>
                    <div class="state-example">
                        <div class="state-example-indicator state-learning">L</div>
                        <span>Learning - Actively practicing</span>
                    </div>
                    <div class="state-example">
                        <div class="state-example-indicator state-review">R</div>
                        <span>Review - Reinforcing memory</span>
                    </div>
                    <div class="state-example">
                        <div class="state-example-indicator state-mastered">M</div>
                        <span>Mastered - Long-term retention</span>
                    </div>
                </div>

                <h4>üìö Study Mode</h4>
                <ul>
                    <li>Click cards to flip and see meanings</li>
                    <li>Use audio buttons to hear pronunciation</li>
                    <li>Cards automatically progress through learning states</li>
                </ul>

                <h4>üß† Quiz Modes</h4>
                <ul>
                    <li><strong>Multiple Choice:</strong> Standard Japanese ‚Üí English</li>
                    <li><strong>Listening First:</strong> Audio-based learning</li>
                    <li><strong>Mixed Challenge:</strong> Random JP‚ÜíEN or EN‚ÜíJP</li>
                    <li><strong>Speed Challenge:</strong> 8-second time pressure</li>
                    <li><strong>Kanji Only:</strong> Focus on character recognition</li>
                </ul>

                <h4>‚öôÔ∏è Controls & Tips</h4>
                <ul>
                    <li><strong>Keyboard Shortcuts:</strong> Space/Enter (flip/next), Arrow keys (navigate), 1-4 (quiz answers), K (toggle kana)</li>
                    <li><strong>Kana Toggle (K):</strong> Show/hide readings in quiz mode</li>
                    <li><strong>Filters:</strong> Study specific word types (nouns, verbs, adjectives)</li>
                </ul>

                <h4>üìä Progress Tracking</h4>
                <p>Your progress is automatically saved. The system tracks your performance and adjusts review timing to maximize retention.</p>
            </div>
            
            <div class="form-buttons">
                <button type="button" class="btn btn-primary" onclick="hideLearningInfo()">Got it!</button>
            </div>
        </div>
    </div>

    <div class="success-message" id="successMessage">
        ‚úÖ Thank you for your feedback!
    </div>

    <!-- JavaScript Files -->
    <script type="module" src="assets/js/core/vocabulary.js"></script>
    <script type="module" src="assets/js/core/storage.js"></script>
    <script type="module" src="assets/js/core/spacedRepetition.js"></script>
    <script type="module" src="assets/js/features/audioSystem.js"></script>
    <script type="module" src="assets/js/app.js"></script>
</body>
</html>