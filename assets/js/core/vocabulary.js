// assets/js/core/vocabulary.js
export const N5_VOCABULARY = [
    {japanese:"姉",reading:"あね",meaning:"older sister",type:"noun"},
    {japanese:"兄",reading:"あに",meaning:"older brother",type:"noun"},
    {japanese:"父",reading:"ちち",meaning:"father",type:"noun"},
    {japanese:"母",reading:"はは",meaning:"mother",type:"noun"},
    {japanese:"子供",reading:"こども",meaning:"child",type:"noun"},
    {japanese:"大人",reading:"おとな",meaning:"adult",type:"noun"},
    {japanese:"男",reading:"おとこ",meaning:"man",type:"noun"},
    {japanese:"女",reading:"おんな",meaning:"woman",type:"noun"},
    {japanese:"弟",reading:"おとうと",meaning:"younger brother",type:"noun"},
    {japanese:"妹",reading:"いもうと",meaning:"younger sister",type:"noun"},
    {japanese:"お母さん",reading:"おかあさん",meaning:"mother",type:"noun"},
    {japanese:"お父さん",reading:"おとうさん",meaning:"father",type:"noun"},
    {japanese:"人",reading:"ひと",meaning:"person",type:"noun"},
    {japanese:"友達",reading:"ともだち",meaning:"friend",type:"noun"},
    {japanese:"名前",reading:"なまえ",meaning:"name",type:"noun"},
    {japanese:"学生",reading:"がくせい",meaning:"student",type:"noun"},
    {japanese:"先生",reading:"せんせい",meaning:"teacher",type:"noun"},
    {japanese:"生徒",reading:"せいと",meaning:"pupil",type:"noun"},
    {japanese:"医者",reading:"いしゃ",meaning:"doctor",type:"noun"},
    {japanese:"頭",reading:"あたま",meaning:"head",type:"noun"},
    {japanese:"手",reading:"て",meaning:"hand",type:"noun"},
    {japanese:"足",reading:"あし",meaning:"foot",type:"noun"},
    {japanese:"目",reading:"め",meaning:"eye",type:"noun"},
    {japanese:"耳",reading:"みみ",meaning:"ear",type:"noun"},
    {japanese:"鼻",reading:"はな",meaning:"nose",type:"noun"},
    {japanese:"口",reading:"くち",meaning:"mouth",type:"noun"},
    {japanese:"体",reading:"からだ",meaning:"body",type:"noun"},
    {japanese:"朝",reading:"あさ",meaning:"morning",type:"noun"},
    {japanese:"昼",reading:"ひる",meaning:"noon",type:"noun"},
    {japanese:"晩",reading:"ばん",meaning:"evening",type:"noun"},
    {japanese:"夜",reading:"よる",meaning:"night",type:"noun"},
    {japanese:"今日",reading:"きょう",meaning:"today",type:"noun"},
    {japanese:"明日",reading:"あした",meaning:"tomorrow",type:"noun"},
    {japanese:"昨日",reading:"きのう",meaning:"yesterday",type:"noun"},
    {japanese:"毎日",reading:"まいにち",meaning:"every day",type:"noun"},
    {japanese:"今週",reading:"こんしゅう",meaning:"this week",type:"noun"},
    {japanese:"来週",reading:"らいしゅう",meaning:"next week",type:"noun"},
    {japanese:"今月",reading:"こんげつ",meaning:"this month",type:"noun"},
    {japanese:"来月",reading:"らいげつ",meaning:"next month",type:"noun"},
    {japanese:"今年",reading:"ことし",meaning:"this year",type:"noun"},
    {japanese:"来年",reading:"らいねん",meaning:"next year",type:"noun"},
    {japanese:"時間",reading:"じかん",meaning:"time",type:"noun"},
    {japanese:"月曜日",reading:"げつようび",meaning:"Monday",type:"noun"},
    {japanese:"火曜日",reading:"かようび",meaning:"Tuesday",type:"noun"},
    {japanese:"水曜日",reading:"すいようび",meaning:"Wednesday",type:"noun"},
    {japanese:"木曜日",reading:"もくようび",meaning:"Thursday",type:"noun"},
    {japanese:"金曜日",reading:"きんようび",meaning:"Friday",type:"noun"},
    {japanese:"土曜日",reading:"どようび",meaning:"Saturday",type:"noun"},
    {japanese:"日曜日",reading:"にちようび",meaning:"Sunday",type:"noun"},
    {japanese:"一",reading:"いち",meaning:"one",type:"noun"},
    {japanese:"二",reading:"に",meaning:"two",type:"noun"},
    {japanese:"三",reading:"さん",meaning:"three",type:"noun"},
    {japanese:"四",reading:"し",meaning:"four",type:"noun"},
    {japanese:"五",reading:"ご",meaning:"five",type:"noun"},
    {japanese:"六",reading:"ろく",meaning:"six",type:"noun"},
    {japanese:"七",reading:"しち",meaning:"seven",type:"noun"},
    {japanese:"八",reading:"はち",meaning:"eight",type:"noun"},
    {japanese:"九",reading:"きゅう",meaning:"nine",type:"noun"},
    {japanese:"十",reading:"じゅう",meaning:"ten",type:"noun"},
    {japanese:"家",reading:"いえ",meaning:"house",type:"noun"},
    {japanese:"学校",reading:"がっこう",meaning:"school",type:"noun"},
    {japanese:"図書館",reading:"としょかん",meaning:"library",type:"noun"},
    {japanese:"銀行",reading:"ぎんこう",meaning:"bank",type:"noun"},
    {japanese:"店",reading:"みせ",meaning:"store",type:"noun"},
    {japanese:"駅",reading:"えき",meaning:"station",type:"noun"},
    {japanese:"空港",reading:"くうこう",meaning:"airport",type:"noun"},
    {japanese:"部屋",reading:"へや",meaning:"room",type:"noun"},
    {japanese:"町",reading:"まち",meaning:"town",type:"noun"},
    {japanese:"国",reading:"くに",meaning:"country",type:"noun"},
    {japanese:"日本",reading:"にほん",meaning:"Japan",type:"noun"},
    {japanese:"車",reading:"くるま",meaning:"car",type:"noun"},
    {japanese:"電車",reading:"でんしゃ",meaning:"train",type:"noun"},
    {japanese:"バス",reading:"ばす",meaning:"bus",type:"noun"},
    {japanese:"飛行機",reading:"ひこうき",meaning:"airplane",type:"noun"},
    {japanese:"自転車",reading:"じてんしゃ",meaning:"bicycle",type:"noun"},
    {japanese:"ご飯",reading:"ごはん",meaning:"rice/meal",type:"noun"},
    {japanese:"朝ご飯",reading:"あさごはん",meaning:"breakfast",type:"noun"},
    {japanese:"昼ご飯",reading:"ひるごはん",meaning:"lunch",type:"noun"},
    {japanese:"晩ご飯",reading:"ばんごはん",meaning:"dinner",type:"noun"},
    {japanese:"パン",reading:"ぱん",meaning:"bread",type:"noun"},
    {japanese:"肉",reading:"にく",meaning:"meat",type:"noun"},
    {japanese:"魚",reading:"さかな",meaning:"fish",type:"noun"},
    {japanese:"野菜",reading:"やさい",meaning:"vegetable",type:"noun"},
    {japanese:"果物",reading:"くだもの",meaning:"fruit",type:"noun"},
    {japanese:"水",reading:"みず",meaning:"water",type:"noun"},
    {japanese:"お茶",reading:"おちゃ",meaning:"tea",type:"noun"},
    {japanese:"コーヒー",reading:"こーひー",meaning:"coffee",type:"noun"},
    {japanese:"牛乳",reading:"ぎゅうにゅう",meaning:"milk",type:"noun"},
    {japanese:"ビール",reading:"びーる",meaning:"beer",type:"noun"},
    {japanese:"山",reading:"やま",meaning:"mountain",type:"noun"},
    {japanese:"川",reading:"かわ",meaning:"river",type:"noun"},
    {japanese:"海",reading:"うみ",meaning:"sea",type:"noun"},
    {japanese:"雪",reading:"ゆき",meaning:"snow",type:"noun"},
    {japanese:"雨",reading:"あめ",meaning:"rain",type:"noun"},
    {japanese:"風",reading:"かぜ",meaning:"wind",type:"noun"},
    {japanese:"空",reading:"そら",meaning:"sky",type:"noun"},
    {japanese:"天気",reading:"てんき",meaning:"weather",type:"noun"},
    {japanese:"春",reading:"はる",meaning:"spring",type:"noun"},
    {japanese:"夏",reading:"なつ",meaning:"summer",type:"noun"},
    {japanese:"秋",reading:"あき",meaning:"autumn",type:"noun"},
    {japanese:"冬",reading:"ふゆ",meaning:"winter",type:"noun"},
    {japanese:"花",reading:"はな",meaning:"flower",type:"noun"},
    {japanese:"犬",reading:"いぬ",meaning:"dog",type:"noun"},
    {japanese:"猫",reading:"ねこ",meaning:"cat",type:"noun"},
    {japanese:"鳥",reading:"とり",meaning:"bird",type:"noun"},
    {japanese:"動物",reading:"どうぶつ",meaning:"animal",type:"noun"},
    {japanese:"赤",reading:"あか",meaning:"red",type:"noun"},
    {japanese:"青",reading:"あお",meaning:"blue",type:"noun"},
    {japanese:"白",reading:"しろ",meaning:"white",type:"noun"},
    {japanese:"黒",reading:"くろ",meaning:"black",type:"noun"},
    {japanese:"緑",reading:"みどり",meaning:"green",type:"noun"},
    {japanese:"色",reading:"いろ",meaning:"color",type:"noun"},
    {japanese:"本",reading:"ほん",meaning:"book",type:"noun"},
    {japanese:"ペン",reading:"ぺん",meaning:"pen",type:"noun"},
    {japanese:"鉛筆",reading:"えんぴつ",meaning:"pencil",type:"noun"},
    {japanese:"机",reading:"つくえ",meaning:"desk",type:"noun"},
    {japanese:"椅子",reading:"いす",meaning:"chair",type:"noun"},
    {japanese:"時計",reading:"とけい",meaning:"clock",type:"noun"},
    {japanese:"傘",reading:"かさ",meaning:"umbrella",type:"noun"},
    {japanese:"鞄",reading:"かばん",meaning:"bag",type:"noun"},
    {japanese:"靴",reading:"くつ",meaning:"shoes",type:"noun"},
    {japanese:"服",reading:"ふく",meaning:"clothes",type:"noun"},
    {japanese:"眼鏡",reading:"めがね",meaning:"glasses",type:"noun"},
    {japanese:"テレビ",reading:"てれび",meaning:"television",type:"noun"},
    {japanese:"電話",reading:"でんわ",meaning:"telephone",type:"noun"},
    {japanese:"勉強",reading:"べんきょう",meaning:"study",type:"noun"},
    {japanese:"仕事",reading:"しごと",meaning:"work",type:"noun"},
    {japanese:"買い物",reading:"かいもの",meaning:"shopping",type:"noun"},
    {japanese:"旅行",reading:"りょこう",meaning:"travel",type:"noun"},
    {japanese:"散歩",reading:"さんぽ",meaning:"walk",type:"noun"},
    {japanese:"運動",reading:"うんどう",meaning:"exercise",type:"noun"},
    {japanese:"音楽",reading:"おんがく",meaning:"music",type:"noun"},
    {japanese:"映画",reading:"えいが",meaning:"movie",type:"noun"},
    {japanese:"写真",reading:"しゃしん",meaning:"photograph",type:"noun"},
    {japanese:"お金",reading:"おかね",meaning:"money",type:"noun"},
    {japanese:"行く",reading:"いく",meaning:"to go",type:"verb"},
    {japanese:"来る",reading:"くる",meaning:"to come",type:"verb"},
    {japanese:"帰る",reading:"かえる",meaning:"to return",type:"verb"},
    {japanese:"食べる",reading:"たべる",meaning:"to eat",type:"verb"},
    {japanese:"飲む",reading:"のむ",meaning:"to drink",type:"verb"},
    {japanese:"見る",reading:"みる",meaning:"to see",type:"verb"},
    {japanese:"聞く",reading:"きく",meaning:"to listen",type:"verb"},
    {japanese:"読む",reading:"よむ",meaning:"to read",type:"verb"},
    {japanese:"書く",reading:"かく",meaning:"to write",type:"verb"},
    {japanese:"話す",reading:"はなす",meaning:"to speak",type:"verb"},
    {japanese:"寝る",reading:"ねる",meaning:"to sleep",type:"verb"},
    {japanese:"起きる",reading:"おきる",meaning:"to wake up",type:"verb"},
    {japanese:"立つ",reading:"たつ",meaning:"to stand",type:"verb"},
    {japanese:"座る",reading:"すわる",meaning:"to sit",type:"verb"},
    {japanese:"歩く",reading:"あるく",meaning:"to walk",type:"verb"},
    {japanese:"走る",reading:"はしる",meaning:"to run",type:"verb"},
    {japanese:"休む",reading:"やすむ",meaning:"to rest",type:"verb"},
    {japanese:"働く",reading:"はたらく",meaning:"to work",type:"verb"},
    {japanese:"勉強する",reading:"べんきょうする",meaning:"to study",type:"verb"},
    {japanese:"買う",reading:"かう",meaning:"to buy",type:"verb"},
    {japanese:"作る",reading:"つくる",meaning:"to make",type:"verb"},
    {japanese:"開く",reading:"あく",meaning:"to open",type:"verb"},
    {japanese:"閉める",reading:"しめる",meaning:"to close",type:"verb"},
    {japanese:"入る",reading:"はいる",meaning:"to enter",type:"verb"},
    {japanese:"出る",reading:"でる",meaning:"to exit",type:"verb"},
    {japanese:"着る",reading:"きる",meaning:"to wear",type:"verb"},
    {japanese:"待つ",reading:"まつ",meaning:"to wait",type:"verb"},
    {japanese:"会う",reading:"あう",meaning:"to meet",type:"verb"},
    {japanese:"教える",reading:"おしえる",meaning:"to teach",type:"verb"},
    {japanese:"習う",reading:"ならう",meaning:"to learn",type:"verb"},
    {japanese:"もらう",reading:"もらう",meaning:"to receive",type:"verb"},
    {japanese:"あげる",reading:"あげる",meaning:"to give",type:"verb"},
    {japanese:"忘れる",reading:"わすれる",meaning:"to forget",type:"verb"},
    {japanese:"覚える",reading:"おぼえる",meaning:"to remember",type:"verb"},
    {japanese:"知る",reading:"しる",meaning:"to know",type:"verb"},
    {japanese:"分かる",reading:"わかる",meaning:"to understand",type:"verb"},
    {japanese:"住む",reading:"すむ",meaning:"to live",type:"verb"},
    {japanese:"使う",reading:"つかう",meaning:"to use",type:"verb"},
    {japanese:"持つ",reading:"もつ",meaning:"to have/hold",type:"verb"},
    {japanese:"新しい",reading:"あたらしい",meaning:"new",type:"i-adjective"},
    {japanese:"古い",reading:"ふるい",meaning:"old",type:"i-adjective"},
    {japanese:"大きい",reading:"おおきい",meaning:"big",type:"i-adjective"},
    {japanese:"小さい",reading:"ちいさい",meaning:"small",type:"i-adjective"},
    {japanese:"高い",reading:"たかい",meaning:"expensive/tall",type:"i-adjective"},
    {japanese:"安い",reading:"やすい",meaning:"cheap",type:"i-adjective"},
    {japanese:"いい",reading:"いい",meaning:"good",type:"i-adjective"},
    {japanese:"悪い",reading:"わるい",meaning:"bad",type:"i-adjective"},
    {japanese:"美味しい",reading:"おいしい",meaning:"delicious",type:"i-adjective"},
    {japanese:"暑い",reading:"あつい",meaning:"hot",type:"i-adjective"},
    {japanese:"寒い",reading:"さむい",meaning:"cold",type:"i-adjective"},
    {japanese:"暖かい",reading:"あたたかい",meaning:"warm",type:"i-adjective"},
    {japanese:"涼しい",reading:"すずしい",meaning:"cool",type:"i-adjective"},
    {japanese:"明るい",reading:"あかるい",meaning:"bright",type:"i-adjective"},
    {japanese:"暗い",reading:"くらい",meaning:"dark",type:"i-adjective"},
    {japanese:"重い",reading:"おもい",meaning:"heavy",type:"i-adjective"},
    {japanese:"軽い",reading:"かるい",meaning:"light",type:"i-adjective"},
    {japanese:"強い",reading:"つよい",meaning:"strong",type:"i-adjective"},
    {japanese:"弱い",reading:"よわい",meaning:"weak",type:"i-adjective"},
    {japanese:"長い",reading:"ながい",meaning:"long",type:"i-adjective"},
    {japanese:"短い",reading:"みじかい",meaning:"short",type:"i-adjective"},
    {japanese:"広い",reading:"ひろい",meaning:"wide",type:"i-adjective"},
    {japanese:"狭い",reading:"せまい",meaning:"narrow",type:"i-adjective"},
    {japanese:"多い",reading:"おおい",meaning:"many",type:"i-adjective"},
    {japanese:"少ない",reading:"すくない",meaning:"few",type:"i-adjective"},
    {japanese:"早い",reading:"はやい",meaning:"early",type:"i-adjective"},
    {japanese:"遅い",reading:"おそい",meaning:"late",type:"i-adjective"},
    {japanese:"速い",reading:"はやい",meaning:"fast",type:"i-adjective"},
    {japanese:"遠い",reading:"とおい",meaning:"far",type:"i-adjective"},
    {japanese:"近い",reading:"ちかい",meaning:"near",type:"i-adjective"},
    {japanese:"難しい",reading:"むずかしい",meaning:"difficult",type:"i-adjective"},
    {japanese:"易しい",reading:"やさしい",meaning:"easy",type:"i-adjective"},
    {japanese:"面白い",reading:"おもしろい",meaning:"interesting",type:"i-adjective"},
    {japanese:"楽しい",reading:"たのしい",meaning:"fun",type:"i-adjective"},
    {japanese:"忙しい",reading:"いそがしい",meaning:"busy",type:"i-adjective"},
    {japanese:"若い",reading:"わかい",meaning:"young",type:"i-adjective"},
    {japanese:"赤い",reading:"あかい",meaning:"red",type:"i-adjective"},
    {japanese:"青い",reading:"あおい",meaning:"blue",type:"i-adjective"},
    {japanese:"白い",reading:"しろい",meaning:"white",type:"i-adjective"},
    {japanese:"黒い",reading:"くろい",meaning:"black",type:"i-adjective"},
    {japanese:"可愛い",reading:"かわいい",meaning:"cute",type:"i-adjective"},
    {japanese:"美しい",reading:"うつくしい",meaning:"beautiful",type:"i-adjective"},
    {japanese:"有名",reading:"ゆうめい",meaning:"famous",type:"na-adjective"},
    {japanese:"便利",reading:"べんり",meaning:"convenient",type:"na-adjective"},
    {japanese:"綺麗",reading:"きれい",meaning:"beautiful/clean",type:"na-adjective"},
    {japanese:"静か",reading:"しずか",meaning:"quiet",type:"na-adjective"},
    {japanese:"親切",reading:"しんせつ",meaning:"kind",type:"na-adjective"},
    {japanese:"簡単",reading:"かんたん",meaning:"simple",type:"na-adjective"},
    {japanese:"大変",reading:"たいへん",meaning:"tough/hard",type:"na-adjective"},
    {japanese:"大丈夫",reading:"だいじょうぶ",meaning:"OK/alright",type:"na-adjective"},
    {japanese:"安全",reading:"あんぜん",meaning:"safe",type:"na-adjective"},
    {japanese:"危険",reading:"きけん",meaning:"dangerous",type:"na-adjective"},
    {japanese:"大切",reading:"たいせつ",meaning:"important",type:"na-adjective"},
    {japanese:"特別",reading:"とくべつ",meaning:"special",type:"na-adjective"},
    {japanese:"普通",reading:"ふつう",meaning:"normal",type:"na-adjective"},
    {japanese:"好き",reading:"すき",meaning:"like",type:"na-adjective"},
    {japanese:"嫌い",reading:"きらい",meaning:"dislike",type:"na-adjective"},
    {japanese:"上手",reading:"じょうず",meaning:"skillful",type:"na-adjective"},
    {japanese:"下手",reading:"へた",meaning:"unskillful",type:"na-adjective"},
    {japanese:"元気",reading:"げんき",meaning:"healthy/energetic",type:"na-adjective"}
];

export class VocabularyManager {
    constructor() {
        this.vocabulary = N5_VOCABULARY;
        this.wordCounts = this.calculateWordCounts();
    }

    calculateWordCounts() {
        const counts = {
            all: this.vocabulary.length,
            noun: 0,
            verb: 0,
            'i-adjective': 0,
            'na-adjective': 0
        };

        this.vocabulary.forEach(card => {
            if (counts[card.type] !== undefined) {
                counts[card.type]++;
            }
        });

        return counts;
    }

    getWordCounts() {
        return { ...this.wordCounts };
    }

    filterByTypes(types) {
        if (types.includes('all')) {
            return [...this.vocabulary];
        }

        return this.vocabulary.filter(card => types.includes(card.type));
    }

    shuffleArray(array) {
        if (!array || array.length === 0) return [];
        
        const newArray = [...array];
        for (let i = newArray.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
        }
        return newArray;
    }

    interleavedShuffle(array) {
        if (!array || array.length <= 1) return array.slice();
        
        const cardsByType = {
            noun: [],
            verb: [],
            'i-adjective': [],
            'na-adjective': []
        };
        
        array.forEach(card => {
            if (cardsByType[card.type]) {
                cardsByType[card.type].push(card);
            }
        });
        
        Object.keys(cardsByType).forEach(type => {
            cardsByType[type] = this.shuffleArray(cardsByType[type]);
        });
        
        const result = [];
        const typeKeys = Object.keys(cardsByType).filter(type => cardsByType[type].length > 0);
        
        if (typeKeys.length === 0) return this.shuffleArray(array);
        
        let typeIndex = 0;
        while (result.length < array.length) {
            const currentType = typeKeys[typeIndex % typeKeys.length];
            if (cardsByType[currentType].length > 0) {
                result.push(cardsByType[currentType].shift());
            }
            
            if (cardsByType[currentType].length === 0) {
                typeKeys.splice(typeKeys.indexOf(currentType), 1);
                if (typeKeys.length === 0) break;
            }
            
            typeIndex++;
        }
        
        // Light shuffle to add variety while maintaining type distribution
        const lightShuffled = [...result];
        const swapCount = Math.max(1, Math.floor(array.length * 0.15));
        
        for (let i = 0; i < swapCount; i++) {
            const pos1 = Math.floor(Math.random() * lightShuffled.length);
            const pos2 = Math.floor(Math.random() * lightShuffled.length);
            [lightShuffled[pos1], lightShuffled[pos2]] = [lightShuffled[pos2], lightShuffled[pos1]];
        }
        
        return lightShuffled;
    }

    generateQuizOptions(correctCard, count = 4, sameTypeWeight = 0.7) {
        const options = [correctCard];
        const otherCards = this.vocabulary.filter(card => 
            card.japanese !== correctCard.japanese
        );
        
        if (otherCards.length === 0) return options;
        
        const sameTypeCards = this.shuffleArray(
            otherCards.filter(card => card.type === correctCard.type)
        );
        const diffTypeCards = this.shuffleArray(
            otherCards.filter(card => card.type !== correctCard.type)
        );
        
        const wrongAnswers = [];
        const sameTypeCount = Math.floor((count - 1) * sameTypeWeight);
        
        // Add same type words
        if (sameTypeCards.length > 0) {
            wrongAnswers.push(...sameTypeCards.slice(0, Math.min(sameTypeCount, sameTypeCards.length)));
        }
        
        // Fill remaining slots with different types
        const remainingSlots = (count - 1) - wrongAnswers.length;
        if (remainingSlots > 0 && diffTypeCards.length > 0) {
            wrongAnswers.push(...diffTypeCards.slice(0, remainingSlots));
        }
        
        // If still need more, use any available cards
        while (wrongAnswers.length < (count - 1) && otherCards.length >= (count - 1)) {
            const remaining = otherCards.filter(card => 
                !wrongAnswers.some(wa => wa.japanese === card.japanese)
            );
            if (remaining.length > 0) {
                wrongAnswers.push(remaining[Math.floor(Math.random() * remaining.length)]);
            } else {
                break;
            }
        }
        
        options.push(...wrongAnswers);
        return this.shuffleArray(options);
    }

    searchWords(query) {
        if (!query || query.trim() === '') return [...this.vocabulary];
        
        const searchTerm = query.toLowerCase().trim();
        
        return this.vocabulary.filter(card => 
            card.japanese.toLowerCase().includes(searchTerm) ||
            card.reading.toLowerCase().includes(searchTerm) ||
            card.meaning.toLowerCase().includes(searchTerm)
        );
    }

    getRandomWord(excludeWords = []) {
        const availableWords = this.vocabulary.filter(card => 
            !excludeWords.includes(card.japanese)
        );
        
        if (availableWords.length === 0) return null;
        
        return availableWords[Math.floor(Math.random() * availableWords.length)];
    }

    getWordByJapanese(japanese) {
        return this.vocabulary.find(card => card.japanese === japanese) || null;
    }

    getAllWords() {
        return [...this.vocabulary];
    }
}