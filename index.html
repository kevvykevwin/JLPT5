<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JLPT N5 Flashcards - Adaptive Learning System</title>
    <meta name="description" content="Master JLPT N5 vocabulary with spaced repetition, adaptive quizzes, and pronunciation practice.">
    <meta name="keywords" content="JLPT N5, Japanese vocabulary, flashcards, spaced repetition, kanji practice">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üáØüáµ</text></svg>">
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#667eea">
    
    <!-- Modular CSS -->
    <link rel="stylesheet" href="assets/css/base.css">
    <link rel="stylesheet" href="assets/css/components.css">
    <link rel="stylesheet" href="assets/css/quiz.css">
    <link rel="stylesheet" href="assets/css/responsive.css">
</head>
<body>
    <div class="flashcard-container">
        <!-- Header Section -->
        <div class="header">
            <!-- Filter Menu -->
            <div class="menu-container">
                <div class="hamburger-menu" id="hamburgerMenu">
                    <div class="hamburger-icon">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </div>
                <div class="dropdown-menu" id="dropdownMenu">
                    <div class="filter-section">
                        <div class="filter-section-title">Word Types</div>
                        
                        <div class="filter-option" data-filter="all">
                            <div class="toggle-switch">
                                <input type="checkbox" id="filterAll" checked>
                                <span class="toggle-slider"></span>
                            </div>
                            <label for="filterAll">All Words</label>
                            <span class="word-count-badge" id="allCount">0</span>
                        </div>
                        
                        <div class="filter-option" data-filter="noun">
                            <div class="toggle-switch">
                                <input type="checkbox" id="filterNouns">
                                <span class="toggle-slider"></span>
                            </div>
                            <label for="filterNouns">Nouns</label>
                            <span class="word-count-badge" id="nounCount">0</span>
                        </div>
                        
                        <div class="filter-option" data-filter="verb">
                            <div class="toggle-switch">
                                <input type="checkbox" id="filterVerbs">
                                <span class="toggle-slider"></span>
                            </div>
                            <label for="filterVerbs">Verbs</label>
                            <span class="word-count-badge" id="verbCount">0</span>
                        </div>
                        
                        <div class="filter-option" data-filter="i-adjective">
                            <div class="toggle-switch">
                                <input type="checkbox" id="filterIAdj">
                                <span class="toggle-slider"></span>
                            </div>
                            <label for="filterIAdj">„ÅÑ-Adjectives</label>
                            <span class="word-count-badge" id="iAdjCount">0</span>
                        </div>
                        
                        <div class="filter-option" data-filter="na-adjective">
                            <div class="toggle-switch">
                                <input type="checkbox" id="filterNaAdj">
                                <span class="toggle-slider"></span>
                            </div>
                            <label for="filterNaAdj">„Å™-Adjectives</label>
                            <span class="word-count-badge" id="naAdjCount">0</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <h1>JLPT N5 Adaptive Learning</h1>
            
            <!-- Retention Prompt -->
            <div id="retentionPrompt" class="retention-prompt">
                ‚ú® Some of these help strengthen memory retention (<span id="reviewCount">0</span> reviews mixed in)
            </div>

            <!-- Tab Navigation -->
            <div class="tab-container">
                <button class="tab-button active" data-tab="study">üìö Study</button>
                <button class="tab-button" data-tab="quiz">üß† Quiz</button>
            </div>
            
            <!-- Progress Bar -->
            <div class="progress">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            
            <!-- Card Info -->
            <div class="card-info">
                <div id="cardCounter">Card 1 of 0</div>
                <div id="cardType">Adaptive</div>
            </div>
        </div>
        
        <!-- Study Tab -->
        <div class="tab-content active" id="studyTab">
            <div class="flashcard" id="flashcard" onclick="flipCard()">
                <div class="learning-state-indicator" id="stateIndicator">N</div>
                <button class="audio-button" id="audioButton" onclick="playAudio(event)" title="Listen to pronunciation">
                    üîä
                </button>
                <div class="prompt-text" id="promptText"></div>
                <div class="japanese-word" id="japaneseWord">Loading vocabulary...</div>
                <div class="reading" id="reading">Please wait...</div>
                <div class="meaning" id="meaning" style="display: none;">Loading...</div>
            </div>
        </div>

        <!-- Quiz Tab - FIXED: Correct default kana toggle label -->
        <div class="tab-content" id="quizTab">
            <!-- Quiz Mode Selector -->
            <div class="quiz-mode-selector">
                <button class="quiz-mode-btn active" data-mode="multiple-choice">Multiple Choice</button>
                <button class="quiz-mode-btn" data-mode="listening-first">Listening First</button>
                <button class="quiz-mode-btn" data-mode="mixed-challenge">Mixed Challenge</button>
                <button class="quiz-mode-btn" data-mode="speed-challenge">Speed Challenge</button>
                <button class="quiz-mode-btn" data-mode="kanji-only">Kanji Only</button>
            </div>

            <!-- Quiz Container -->
            <div class="quiz-container active" id="quizContainer">
                <!-- FIXED: Kana toggle with correct default label "Show: Kana" -->
                <div class="kana-toggle-container" id="kanaToggleContainer">
                    <div class="kana-toggle-switch">
                        <input type="checkbox" id="kanaToggleInput">
                        <span class="toggle-slider"></span>
                    </div>
                    <label for="kanaToggleInput" id="kanaToggleLabel">Show: Kana</label>
                </div>
                
                <!-- Quiz Question -->
                <div class="japanese-word quiz-question" id="quizQuestion">What does this mean?</div>
                
                <!-- Audio Section (for listening mode) -->
                <div id="quizAudioSection" class="quiz-audio-section" style="display: none;">
                    <button class="quiz-audio-button" id="quizAudioButton" onclick="playAudio(event)" title="Listen to pronunciation">
                        üîä
                    </button>
                    <div class="quiz-audio-label">Click to listen</div>
                </div>
                
                <!-- Quiz Options -->
                <div class="quiz-options" id="quizOptions"></div>
                
                <!-- Quiz Feedback -->
                <div class="quiz-feedback" id="quizFeedback"></div>
            </div>
        </div>
        
        <!-- Control Buttons -->
        <div class="controls">
            <button class="btn btn-secondary" onclick="previousCard()">‚Üê Previous</button>
            <button class="btn btn-primary" onclick="flipCard()" id="flipBtn">Flip Card</button>
            <button class="btn btn-primary" onclick="nextCard()">Next ‚Üí</button>
        </div>
        
        <div class="controls">
            <button class="btn btn-secondary" onclick="shuffleCards()">üîÄ Shuffle</button>
            <button class="btn btn-secondary" onclick="resetProgress()">üîÑ Reset</button>
            <button class="btn btn-secondary" onclick="toggleStats()">üìä Stats</button>
        </div>
        
        <!-- Statistics Panel -->
        <div class="stats" id="stats">
            <h3>üìà Learning Analytics Dashboard</h3>
            
            <div class="learning-overview">
                <div class="learning-stat new">
                    <span class="learning-stat-number" id="statNew">0</span>
                    <span class="learning-stat-label">New</span>
                </div>
                <div class="learning-stat learning">
                    <span class="learning-stat-number" id="statLearning">0</span>
                    <span class="learning-stat-label">Learning</span>
                </div>
                <div class="learning-stat review">
                    <span class="learning-stat-number" id="statReview">0</span>
                    <span class="learning-stat-label">Review</span>
                </div>
                <div class="learning-stat mastered">
                    <span class="learning-stat-number" id="statMastered">0</span>
                    <span class="learning-stat-label">Mastered</span>
                </div>
            </div>
            
            <div id="detailedStats"></div>
            
            <div class="overall-stats">
                <p><strong>Study Session:</strong> <span id="cardsStudied">0</span> cards studied ‚Ä¢ <span id="timesFlipped">0</span> flips</p>
                <p><strong>Learning Progress:</strong> <span id="progressPercent">0%</span> overall mastery</p>
            </div>
        </div>

        <!-- Footer Actions -->
        <div class="footer-actions">
            <button class="footer-btn" onclick="showLearningInfo()">‚ùì How Learning Works</button>
            <button class="footer-btn" onclick="showFeedbackForm()">üí¨ Feedback</button>
            <button class="footer-btn donate-btn" onclick="showDonateInfo()">üíù Donate</button>
        </div>
    </div>

    <!-- Learning Info Modal -->
    <div class="modal-overlay" id="learningModal">
        <div class="modal-content">
            <div class="modal-header">‚ùì How Spaced Repetition Learning Works</div>
            
            <div style="text-align: left; line-height: 1.6; max-height: 400px; overflow-y: auto;">
                <p><strong>üß† Adaptive Learning System:</strong></p>
                <ul style="margin: 10px 0 20px 20px;">
                    <li style="margin-bottom: 8px;"><span style="color: #2196f3; font-weight: bold;">‚óè</span> <strong>New:</strong> Words you haven't studied yet</li>
                    <li style="margin-bottom: 8px;"><span style="color: #ff9800; font-weight: bold;">‚óè</span> <strong>Learning:</strong> Words you're actively memorizing</li>
                    <li style="margin-bottom: 8px;"><span style="color: #9c27b0; font-weight: bold;">‚óè</span> <strong>Review:</strong> Words being reinforced</li>
                    <li style="margin-bottom: 8px;"><span style="color: #4caf50; font-weight: bold;">‚óè</span> <strong>Mastered:</strong> Words you know well</li>
                </ul>
                
                <p><strong>üìà Smart Scheduling:</strong></p>
                <p style="margin-bottom: 20px;">The system automatically schedules reviews based on how well you know each word. Difficult words appear more frequently, while mastered words appear less often - just like the forgetting curve theory suggests.</p>
                
                <p><strong>üéØ Quiz Modes:</strong></p>
                <ul style="margin: 10px 0 20px 20px;">
                    <li style="margin-bottom: 6px;"><strong>Multiple Choice:</strong> Standard recognition practice</li>
                    <li style="margin-bottom: 6px;"><strong>Listening First:</strong> Audio-based recognition</li>
                    <li style="margin-bottom: 6px;"><strong>Mixed Challenge:</strong> Random direction (JP‚ÜíEN or EN‚ÜíJP)</li>
                    <li style="margin-bottom: 6px;"><strong>Speed Challenge:</strong> Quick recall under time pressure</li>
                    <li style="margin-bottom: 6px;"><strong>Kanji Only:</strong> Pure character recognition</li>
                </ul>
                
                <p><strong>üí° Study Tips:</strong></p>
                <p style="margin-bottom: 15px;">Study consistently for short periods rather than long cramming sessions. The spaced repetition algorithm works best with regular exposure over time.</p>
            </div>
            
            <div class="form-buttons">
                <button type="button" class="btn btn-primary" onclick="hideLearningInfo()">Got it!</button>
            </div>
        </div>
    </div>

    <!-- Feedback Modal -->
    <div class="modal-overlay" id="feedbackModal">
        <div class="modal-content">
            <div class="modal-header">üí¨ Share Your Feedback</div>
            
            <form name="jlpt-feedback" method="POST" data-netlify="true" data-netlify-honeypot="bot-field" onsubmit="submitFeedback(event)">
                <input type="hidden" name="bot-field" />
                <input type="hidden" name="form-name" value="jlpt-feedback" />
                
                <div class="form-group">
                    <label class="form-label">Email (optional)</label>
                    <input type="email" name="email" class="form-input" placeholder="your@email.com">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Your feedback</label>
                    <textarea name="feedback" class="form-textarea" 
                              placeholder="How is the spaced repetition system working for you? Any suggestions for improvement?" 
                              required></textarea>
                </div>
                
                <div class="form-buttons">
                    <button type="submit" class="btn btn-primary" style="margin-right: 10px;">Send Feedback</button>
                    <button type="button" class="btn btn-secondary" onclick="hideFeedbackForm()">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Success Message -->
    <div class="success-message" id="successMessage">
        ‚úÖ Thank you for your feedback!
    </div>

    <!-- Modular JavaScript -->
    <script type="module" src="assets/js/app.js"></script>
</body>
</html>