<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JLPT N5 Flashcards - Adaptive Learning System</title>
    <meta name="description" content="Master JLPT N5 vocabulary with spaced repetition, adaptive quizzes, and pronunciation practice. Free Japanese learning tool with 230+ essential words.">
    <meta name="keywords" content="JLPT N5, Japanese vocabulary, flashcards, spaced repetition, kanji practice, Japanese learning">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üáØüáµ</text></svg>">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#667eea">
    
    <!-- External CSS Files -->
    <link rel="stylesheet" href="assets/css/base.css">
    <link rel="stylesheet" href="assets/css/components.css">
    <link rel="stylesheet" href="assets/css/quiz.css">
    <link rel="stylesheet" href="assets/css/responsive.css">
</head>
<body>
    <div class="flashcard-container">
        <div class="header">
            <div class="menu-container">
                <div class="hamburger-menu" id="hamburgerMenu">
                    <div class="hamburger-icon">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </div>
                <div class="dropdown-menu" id="dropdownMenu">
                    <div class="filter-section">
                        <div class="filter-section-title">Word Types</div>
                        <div class="filter-option" data-filter="all">
                            <div class="toggle-switch">
                                <input type="checkbox" id="filterAll" checked>
                                <span class="toggle-slider"></span>
                            </div>
                            <label for="filterAll">All Words</label>
                            <span class="word-count-badge" id="allCount">0</span>
                        </div>
                        <div class="filter-option" data-filter="noun">
                            <div class="toggle-switch">
                                <input type="checkbox" id="filterNouns">
                                <span class="toggle-slider"></span>
                            </div>
                            <label for="filterNouns">Nouns</label>
                            <span class="word-count-badge" id="nounCount">0</span>
                        </div>
                        <div class="filter-option" data-filter="verb">
                            <div class="toggle-switch">
                                <input type="checkbox" id="filterVerbs">
                                <span class="toggle-slider"></span>
                            </div>
                            <label for="filterVerbs">Verbs</label>
                            <span class="word-count-badge" id="verbCount">0</span>
                        </div>
                        <div class="filter-option" data-filter="i-adjective">
                            <div class="toggle-switch">
                                <input type="checkbox" id="filterIAdj">
                                <span class="toggle-slider"></span>
                            </div>
                            <label for="filterIAdj">„ÅÑ-Adjectives</label>
                            <span class="word-count-badge" id="iAdjCount">0</span>
                        </div>
                        <div class="filter-option" data-filter="na-adjective">
                            <div class="toggle-switch">
                                <input type="checkbox" id="filterNaAdj">
                                <span class="toggle-slider"></span>
                            </div>
                            <label for="filterNaAdj">„Å™-Adjectives</label>
                            <span class="word-count-badge" id="naAdjCount">0</span>
                        </div>
                    </div>
                </div>
            </div>
            <h1>JLPT N5 Adaptive Learning</h1>
            
            <div id="retentionPrompt" class="retention-prompt">
                ‚ú® Some of these help strengthen memory retention (<span id="reviewCount">0</span> reviews mixed in)
            </div>

            <div class="tab-container">
                <button class="tab-button active" data-tab="study">üìö Study</button>
                <button class="tab-button" data-tab="quiz">üß† Quiz</button>
            </div>
            
            <div class="progress">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            
            <div class="card-info">
                <div id="cardCounter">Card 1 of 0</div>
                <div id="cardType">Adaptive</div>
            </div>
        </div>
        
        <!-- Study Tab -->
        <div class="tab-content active" id="studyTab">
            <div class="flashcard" id="flashcard">
                <div class="learning-state-indicator" id="stateIndicator">N</div>
                <button class="audio-button" id="audioButton" title="Listen to pronunciation">
                    üîä
                </button>
                <div class="prompt-text" id="promptText"></div>
                <div class="japanese-word" id="japaneseWord">Loading vocabulary...</div>
                <div class="reading" id="reading">Please wait...</div>
                <div class="meaning" id="meaning" style="display: none;">Loading...</div>
            </div>
        </div>

        <!-- Quiz Tab -->
        <div class="tab-content" id="quizTab">
            <div class="quiz-mode-selector">
                <button class="quiz-mode-btn active" data-mode="multiple-choice">Multiple Choice</button>
                <button class="quiz-mode-btn" data-mode="listening-first">Listening First</button>
                <button class="quiz-mode-btn" data-mode="mixed-challenge">Mixed Challenge</button>
                <button class="quiz-mode-btn" data-mode="speed-challenge">Speed Challenge</button>
                <button class="quiz-mode-btn" data-mode="kanji-only">Kanji Only</button>
            </div>

            <!-- Mode Selection Prompt (for initial quiz experience) -->
            <div class="mode-selection-prompt" id="modeSelectionPrompt">
                <div class="mode-selection-title">Choose Your Challenge Level</div>
                <div class="mode-selection-subtitle">Select the quiz mode that matches your learning goals</div>
                <div class="mode-descriptions">
                    <div class="mode-description">
                        <strong>Multiple Choice:</strong> Standard recognition practice with answer options
                    </div>
                    <div class="mode-description">
                        <strong>Listening First:</strong> Audio-based learning to improve pronunciation
                    </div>
                    <div class="mode-description">
                        <strong>Mixed Challenge:</strong> Both Japanese‚ÜíEnglish and English‚ÜíJapanese
                    </div>
                    <div class="mode-description">
                        <strong>Speed Challenge:</strong> 8-second time pressure for fluency building
                    </div>
                    <div class="mode-description">
                        <strong>Kanji Only:</strong> Focus on character recognition without readings
                    </div>
                </div>
            </div>

            <div class="quiz-container active" id="quizContainer">
                <!-- FIXED: Reading Toggle - Now properly positioned inside quiz container -->
                <div class="quiz-reading-toggle">
                    <div class="reading-toggle-switch" id="readingToggleSwitch">
                        <input type="checkbox" id="quizReadingToggle" checked>
                        <span class="reading-switch-slider"></span>
                        <label for="quizReadingToggle" class="reading-switch-label">Show: Kana</label>
                    </div>
                </div>
                
                <!-- Adaptive Batch Progress Indicator -->
                <div class="batch-progress" id="batchProgress">
                    <div class="batch-progress-fill" id="batchProgressFill"></div>
                </div>
                
                <div class="japanese-word quiz-question" id="quizQuestion">What does this mean?</div>
                
                <!-- Audio Section for Listening Mode -->
                <div id="quizAudioSection" class="quiz-audio-section" style="display: none;">
                    <button class="quiz-audio-button" id="quizAudioButton" title="Listen to pronunciation">
                        üîä
                    </button>
                    <div style="font-size: 14px; color: #388e3c; font-weight: 500;">Click to listen</div>
                </div>
                
                <div class="quiz-options" id="quizOptions"></div>
                <div class="quiz-feedback" id="quizFeedback"></div>
            </div>
        </div>
        
        <!-- Controls -->
        <div class="controls">
            <button class="btn btn-secondary" id="previousBtn">‚Üê Previous</button>
            <button class="btn btn-primary" id="flipBtn">Flip Card</button>
            <button class="btn btn-primary" id="nextBtn">Next ‚Üí</button>
        </div>
        
        <div class="controls">
            <button class="btn btn-secondary" id="shuffleBtn">üîÄ Shuffle</button>
            <button class="btn btn-secondary" id="resetBtn">üîÑ Reset</button>
            <button class="btn btn-secondary" id="statsBtn">üìä Stats</button>
        </div>
        
        <!-- Statistics Panel -->
        <div class="stats" id="stats">
            <h3>üìà Learning Analytics Dashboard</h3>
            
            <div class="learning-overview">
                <div class="learning-stat new">
                    <span class="learning-stat-number" id="statNew">0</span>
                    <span class="learning-stat-label">New</span>
                </div>
                <div class="learning-stat learning">
                    <span class="learning-stat-number" id="statLearning">0</span>
                    <span class="learning-stat-label">Learning</span>
                </div>
                <div class="learning-stat review">
                    <span class="learning-stat-number" id="statReview">0</span>
                    <span class="learning-stat-label">Review</span>
                </div>
                <div class="learning-stat mastered">
                    <span class="learning-stat-number" id="statMastered">0</span>
                    <span class="learning-stat-label">Mastered</span>
                </div>
            </div>
            
            <div id="detailedStats"></div>
            
            <div class="overall-stats">
                <p><strong>Study Session:</strong> <span id="cardsStudied">0</span> cards studied ‚Ä¢ <span id="timesFlipped">0</span> flips</p>
                <p><strong>Learning Progress:</strong> <span id="progressPercent">0%</span> overall mastery ‚Ä¢ <span id="quizAccuracy">0%</span> quiz accuracy</p>
            </div>
        </div>

        <!-- Footer Actions -->
        <div class="footer-actions">
            <button class="footer-btn" id="learningGuideBtn">‚ùì How Learning Works</button>
            <button class="footer-btn" id="feedbackBtn">üí¨ Feedback</button>
            <button class="footer-btn donate-btn" id="donateBtn">üíù Donate</button>
        </div>
    </div>

    <!-- Learning Guide Modal -->
    <div class="modal-overlay" id="learningGuideModal">
        <div class="modal-content learning-guide-modal">
            <div class="modal-header">‚ùì How the Adaptive Learning System Works</div>
            
            <div class="learning-guide-content">
                <div class="guide-section">
                    <h4>üîµ New Cards (Blue)</h4>
                    <p>Words you haven't studied yet. Start here to learn new vocabulary. Cards appear immediately for first exposure.</p>
                </div>
                
                <div class="guide-section">
                    <h4>üü° Learning Phase (Orange)</h4>
                    <p>Cards move here after first attempt. Review again in 30 minutes, then 1 day. This reinforces initial learning.</p>
                </div>
                
                <div class="guide-section">
                    <h4>üü£ Review Phase (Purple)</h4>
                    <p>Well-learned cards reviewed every 3-7 days to maintain memory. The system adapts intervals based on your performance.</p>
                </div>
                
                <div class="guide-section">
                    <h4>üü¢ Mastered (Green)</h4>
                    <p>Fully learned words reviewed every 2+ weeks. You've got these down! They appear less frequently but stay fresh.</p>
                </div>
                
                <div class="guide-section">
                    <h4>üß† Spaced Repetition Science</h4>
                    <p>This system uses scientifically-proven spaced repetition intervals to optimize long-term retention. Cards appear just as you're about to forget them, strengthening memory pathways.</p>
                </div>

                <div class="guide-section">
                    <h4>üéØ Adaptive Batch System</h4>
                    <p>Quiz sessions adapt to your performance with batches of 3-12 questions. Better accuracy = longer sessions. Struggling = shorter, focused practice.</p>
                </div>

                <div class="guide-section">
                    <h4>üéÆ Quiz Modes</h4>
                    <p><strong>Multiple Choice:</strong> Standard recognition practice<br>
                    <strong>Listening First:</strong> Audio-based learning<br>
                    <strong>Mixed Challenge:</strong> Both Japanese‚ÜíEnglish and English‚ÜíJapanese<br>
                    <strong>Speed Challenge:</strong> 8-second time pressure for fluency<br>
                    <strong>Kanji Only:</strong> Focus on character recognition</p>
                </div>
            </div>
            
            <div class="form-buttons">
                <button type="button" class="btn btn-primary" id="closeLearningGuideBtn">Got it!</button>
            </div>
        </div>
    </div>

    <!-- Feedback Modal -->
    <div class="modal-overlay" id="feedbackModal">
        <div class="modal-content">
            <div class="modal-header">üí¨ Share Your Feedback</div>
            
            <form name="jlpt-feedback" method="POST" data-netlify="true" data-netlify-honeypot="bot-field" id="feedbackForm">
                <input type="hidden" name="bot-field" />
                <input type="hidden" name="form-name" value="jlpt-feedback" />
                
                <div class="form-group">
                    <label class="form-label">Email (optional)</label>
                    <input type="email" name="email" class="form-input" placeholder="your@email.com">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Your feedback</label>
                    <textarea name="feedback" class="form-textarea" 
                              placeholder="How is the adaptive learning system working for you? Any suggestions for improvement?" 
                              required></textarea>
                </div>
                
                <div class="form-buttons">
                    <button type="submit" class="btn btn-primary" style="margin-right: 10px;">Send Feedback</button>
                    <button type="button" class="btn btn-secondary" id="closeFeedbackBtn">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Success Notification -->
    <div class="success-message" id="successMessage">
        ‚úÖ Thank you for your feedback!
    </div>

    <!-- Main JavaScript Module -->
    <script type="module" src="assets/js/app.js"></script>
    
    <!-- Fallback for browsers without module support -->
    <script nomodule>
        console.warn('ES6 modules not supported. Loading basic fallback...');
        
        // Basic fallback functionality
        function initBasicMode() {
            const japaneseWord = document.getElementById('japaneseWord');
            const reading = document.getElementById('reading');
            const meaning = document.getElementById('meaning');
            const flipBtn = document.getElementById('flipBtn');
            const flashcard = document.getElementById('flashcard');
            
            if (!japaneseWord || !reading || !meaning) {
                console.error('Required elements not found for basic mode');
                return;
            }
            
            // Basic vocabulary subset
            const basicVocab = [
                {japanese:"„Åì„Çì„Å´„Å°„ÅØ",reading:"„Åì„Çì„Å´„Å°„ÅØ",meaning:"hello"},
                {japanese:"„ÅÇ„Çä„Åå„Å®„ÅÜ",reading:"„ÅÇ„Çä„Åå„Å®„ÅÜ",meaning:"thank you"},
                {japanese:"„Åô„Åø„Åæ„Åõ„Çì",reading:"„Åô„Åø„Åæ„Åõ„Çì",meaning:"excuse me"},
                {japanese:"„ÅØ„ÅÑ",reading:"„ÅØ„ÅÑ",meaning:"yes"},
                {japanese:"„ÅÑ„ÅÑ„Åà",reading:"„ÅÑ„ÅÑ„Åà",meaning:"no"}
            ];
            
            let currentIndex = 0;
            let isFlipped = false;
            
            function updateCard() {
                const card = basicVocab[currentIndex];
                japaneseWord.textContent = card.japanese;
                reading.textContent = card.reading;
                meaning.textContent = card.meaning;
                meaning.style.display = 'none';
                isFlipped = false;
                flashcard.classList.remove('flipped');
            }
            
            function flipCard() {
                if (isFlipped) {
                    meaning.style.display = 'none';
                    flashcard.classList.remove('flipped');
                } else {
                    meaning.style.display = 'block';
                    flashcard.classList.add('flipped');
                }
                isFlipped = !isFlipped;
            }
            
            function nextCard() {
                currentIndex = (currentIndex + 1) % basicVocab.length;
                updateCard();
            }
            
            // Event listeners
            if (flipBtn) flipBtn.addEventListener('click', flipCard);
            if (flashcard) flashcard.addEventListener('click', flipCard);
            
            const nextBtn = document.getElementById('nextBtn');
            if (nextBtn) nextBtn.addEventListener('click', nextCard);
            
            // Initialize
            updateCard();
            
            // Show notification
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed; top: 20px; right: 20px; background: #ff9800;
                color: white; padding: 15px 20px; border-radius: 10px;
                box-shadow: 0 4px 15px rgba(255, 152, 0, 0.3); z-index: 1001;
                font-weight: 500; max-width: 300px;
            `;
            notification.textContent = 'Running in basic mode. For full features, please use a modern browser.';
            document.body.appendChild(notification);
            
            setTimeout(() => {
                if (document.body.contains(notification)) {
                    document.body.removeChild(notification);
                }
            }, 5000);
            
            console.log('Basic fallback mode initialized with', basicVocab.length, 'cards');
        }
        
        // Initialize basic mode when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initBasicMode);
        } else {
            initBasicMode();
        }
    </script>
</body>
</html>