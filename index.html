<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JLPT N5 Flashcards - Free Japanese Study Tool</title>
    <meta name="description" content="Free JLPT N5 vocabulary flashcards. Practice Japanese nouns, adjectives with multiple study modes. Perfect for beginners learning Japanese.">
    <meta name="theme-color" content="#667eea">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üáØüáµ</text></svg>">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, rgba(34, 87, 122, 0.9) 0%, rgba(56, 142, 60, 0.9) 50%, rgba(27, 94, 32, 0.9) 100%), 
                        url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 800"><defs><pattern id="tree" x="0" y="0" width="200" height="400" patternUnits="userSpaceOnUse"><circle cx="100" cy="50" r="40" fill="%23388e3c" opacity="0.7"/><circle cx="70" cy="80" r="30" fill="%2343a047" opacity="0.6"/><circle cx="130" cy="75" r="35" fill="%234caf50" opacity="0.8"/><rect x="90" y="100" width="20" height="80" fill="%23795548"/><circle cx="150" cy="120" r="25" fill="%236a994e" opacity="0.7"/><circle cx="50" cy="130" r="20" fill="%23558b2f" opacity="0.6"/></pattern></defs><rect width="100%" height="100%" fill="url(%23tree)"/></svg>') center/cover;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            position: relative;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 600"><g opacity="0.1"><path d="M100,500 Q150,200 200,500 T300,500" stroke="%23388e3c" stroke-width="8" fill="none"/><path d="M400,500 Q450,150 500,500 T600,500" stroke="%23388e3c" stroke-width="12" fill="none"/><circle cx="150" cy="180" r="60" fill="%234caf50"/><circle cx="450" cy="120" r="80" fill="%23558b2f"/><circle cx="180" cy="220" r="40" fill="%236a994e"/><circle cx="420" cy="160" r="50" fill="%2343a047"/><rect x="140" y="240" width="20" height="260" fill="%235d4037"/><rect x="440" y="200" width="25" height="300" fill="%23795548"/></g></svg>') center/cover;
            pointer-events: none;
            z-index: -1;
        }
        
        .flashcard-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(34, 87, 122, 0.3);
            padding: 40px;
            text-align: center;
            max-width: 600px;
            width: 100%;
            border: 1px solid rgba(56, 142, 60, 0.2);
        }
        
        .header h1 {
            color: #1b5e20;
            font-size: 28px;
            margin-bottom: 20px;
            text-shadow: 0 2px 4px rgba(34, 87, 122, 0.1);
        }
        
        .mode-selector {
            margin: 20px 0;
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .mode-btn {
            padding: 8px 16px;
            border: 2px solid #ddd;
            border-radius: 20px;
            background: white;
            color: #666;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }
        
        .mode-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        
        .progress {
            background: #f0f0f0;
            border-radius: 10px;
            height: 8px;
            margin: 20px 0;
        }
        
        .progress-bar {
            background: linear-gradient(90deg, #43a047, #388e3c);
            height: 100%;
            border-radius: 10px;
            transition: width 0.3s ease;
            width: 0%;
        }
        
        .card-info {
            display: flex;
            justify-content: space-between;
            color: #2e7d32;
            font-size: 14px;
            margin-bottom: 20px;
            font-weight: 500;
        }
        
        .flashcard {
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid rgba(56, 142, 60, 0.2);
            border-radius: 15px;
            padding: 40px 20px;
            min-height: 220px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 30px;
            backdrop-filter: blur(5px);
        }
        
        .flashcard:hover {
            border-color: #388e3c;
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(56, 142, 60, 0.2);
        }
        
        .flashcard.flipped {
            background: rgba(232, 245, 233, 0.9);
            border-color: #43a047;
            box-shadow: 0 8px 20px rgba(67, 160, 71, 0.2);
        }
        
        .japanese-word {
            font-size: 42px;
            font-weight: bold;
            color: #1b5e20;
            margin-bottom: 15px;
            font-family: 'Hiragino Sans', 'Yu Gothic', 'Meiryo', sans-serif;
            text-shadow: 0 2px 4px rgba(34, 87, 122, 0.1);
        }
        
        .reading {
            font-size: 22px;
            color: #388e3c;
            margin-bottom: 20px;
            font-weight: 500;
        }
        
        .meaning {
            font-size: 26px;
            color: #2e7d32;
            font-weight: bold;
        }
        
        .prompt-text {
            font-size: 18px;
            color: #457a5a;
            margin-bottom: 20px;
            font-style: italic;
        }
        
        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }
        
        .btn-secondary {
            background: #f0f0f0;
            color: #333;
            border: 2px solid #ddd;
        }
        
        .stats {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            display: none;
        }
        
        .stats.show { display: block; }
        
        @media (max-width: 480px) {
            .flashcard-container { padding: 20px; }
            .japanese-word { font-size: 32px; }
            .controls { flex-direction: column; align-items: center; }
            .btn { width: 100%; max-width: 200px; }
        }
    </style>
</head>
<body>
    <div class="flashcard-container">
        <div class="header">
            <h1>JLPT N5 Comprehensive Study</h1>
            
            <div class="mode-selector">
                <button class="mode-btn active" onclick="setMode('mixed')">üîÄ Mixed Practice</button>
                <button class="mode-btn" onclick="setMode('jp-to-en')">üáØüáµ‚Üíüá∫üá∏ JP to EN</button>
                <button class="mode-btn" onclick="setMode('en-to-jp')">üá∫üá∏‚ÜíüáØüáµ EN to JP</button>
                <button class="mode-btn" onclick="setMode('reading')">üìñ Reading Practice</button>
            </div>
            
            <div class="progress">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            
            <div class="card-info">
                <div id="cardCounter">Card 1 of 280</div>
                <div id="cardType">Mixed</div>
            </div>
        </div>
        
        <div class="flashcard" id="flashcard" onclick="flipCard()">
            <div class="prompt-text" id="promptText"></div>
            <div class="japanese-word" id="japaneseWord">Loading...</div>
            <div class="reading" id="reading">Loading...</div>
            <div class="meaning" id="meaning" style="display: none;">Loading...</div>
        </div>
        
        <div class="controls">
            <button class="btn btn-secondary" onclick="previousCard()">‚Üê Previous</button>
            <button class="btn btn-primary" onclick="flipCard()">Flip Card</button>
            <button class="btn btn-primary" onclick="nextCard()">Next ‚Üí</button>
        </div>
        
        <div class="controls">
            <button class="btn btn-secondary" onclick="shuffleCards()">üîÑ Shuffle</button>
            <button class="btn btn-secondary" onclick="resetProgress()">üîÑ Reset</button>
            <button class="btn btn-secondary" onclick="toggleStats()">üìä Stats</button>
            <button class="btn btn-secondary" onclick="showFeedbackForm()">üí¨ Feedback</button>
        </div>
        
        <div class="stats" id="stats">
            <h3>Study Statistics</h3>
            <p>Cards studied: <span id="cardsStudied">0</span></p>
            <p>Times flipped: <span id="timesFlipped">0</span></p>
            <p>Progress: <span id="progressPercent">0%</span></p>
        </div>

        <!-- Feedback Modal -->
        <div id="feedbackModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; backdrop-filter: blur(3px);">
            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px; border-radius: 15px; max-width: 500px; width: 90%; box-shadow: 0 20px 40px rgba(34, 87, 122, 0.3);">
                <h3 style="color: #1b5e20; margin-bottom: 20px; text-align: center;">üìù Share Your Feedback</h3>
                
                <!-- Hidden Netlify Form -->
                <form name="jlpt-feedback" method="POST" data-netlify="true" data-netlify-honeypot="bot-field" onsubmit="submitFeedback(event)">
                    <!-- Hidden bot field -->
                    <input type="hidden" name="bot-field" />
                    <input type="hidden" name="form-name" value="jlpt-feedback" />
                    
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; color: #2e7d32; margin-bottom: 5px; font-weight: 500;">How would you rate this app?</label>
                        <div id="starRating" style="font-size: 24px; color: #ddd; cursor: pointer; margin-bottom: 10px;">
                            ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
                        </div>
                        <input type="hidden" name="rating" id="ratingValue" value="5">
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; color: #2e7d32; margin-bottom: 5px; font-weight: 500;">Email (optional)</label>
                        <input type="email" name="email" placeholder="your@email.com" 
                               style="width: 100%; padding: 10px; border: 2px solid rgba(56, 142, 60, 0.3); border-radius: 8px; font-size: 14px;">
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; color: #2e7d32; margin-bottom: 5px; font-weight: 500;">Your feedback</label>
                        <textarea name="feedback" placeholder="What do you think about the app? Any suggestions or issues?" 
                                  style="width: 100%; height: 100px; padding: 10px; border: 2px solid rgba(56, 142, 60, 0.3); border-radius: 8px; resize: vertical; font-family: inherit; font-size: 14px;"
                                  required></textarea>
                    </div>
                    
                    <div style="text-align: center;">
                        <button type="submit" class="btn btn-primary" style="margin-right: 10px;">Send Feedback</button>
                        <button type="button" class="btn btn-secondary" onclick="hideFeedbackForm()">Cancel</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Success Message -->
        <div id="successMessage" style="display: none; position: fixed; top: 20px; right: 20px; background: #43a047; color: white; padding: 15px 20px; border-radius: 10px; box-shadow: 0 4px 15px rgba(67, 160, 71, 0.3); z-index: 1001;">
            ‚úÖ Thank you for your feedback!
        </div>
    </div>

    <script>
        // JLPT N5 flashcard data - clean and error-free
        const allFlashcards = [
            // Family & People
            {"japanese": "Âßâ", "reading": "„ÅÇ„Å≠", "meaning": "older sister", "type": "noun"},
            {"japanese": "ÂÖÑ", "reading": "„ÅÇ„Å´", "meaning": "older brother", "type": "noun"},
            {"japanese": "Áà∂", "reading": "„Å°„Å°", "meaning": "father", "type": "noun"},
            {"japanese": "ÊØç", "reading": "„ÅØ„ÅØ", "meaning": "mother", "type": "noun"},
            {"japanese": "ÂÖÑÂºü", "reading": "„Åç„Çá„ÅÜ„Å†„ÅÑ", "meaning": "siblings", "type": "noun"},
            {"japanese": "Â≠ê‰æõ", "reading": "„Åì„Å©„ÇÇ", "meaning": "child", "type": "noun"},
            {"japanese": "Â§ß‰∫∫", "reading": "„Åä„Å®„Å™", "meaning": "adult", "type": "noun"},
            {"japanese": "Áî∑", "reading": "„Åä„Å®„Åì", "meaning": "man", "type": "noun"},
            {"japanese": "Â•≥", "reading": "„Åä„Çì„Å™", "meaning": "woman", "type": "noun"},
            {"japanese": "Áî∑„ÅÆÂ≠ê", "reading": "„Åä„Å®„Åì„ÅÆ„Åì", "meaning": "boy", "type": "noun"},
            {"japanese": "Â•≥„ÅÆÂ≠ê", "reading": "„Åä„Çì„Å™„ÅÆ„Åì", "meaning": "girl", "type": "noun"},
            {"japanese": "Âºü", "reading": "„Åä„Å®„ÅÜ„Å®", "meaning": "younger brother", "type": "noun"},
            {"japanese": "Â¶π", "reading": "„ÅÑ„ÇÇ„ÅÜ„Å®", "meaning": "younger sister", "type": "noun"},
            {"japanese": "„ÅäÊØç„Åï„Çì", "reading": "„Åä„Åã„ÅÇ„Åï„Çì", "meaning": "mother", "type": "noun"},
            {"japanese": "„ÅäÁà∂„Åï„Çì", "reading": "„Åä„Å®„ÅÜ„Åï„Çì", "meaning": "father", "type": "noun"},
            {"japanese": "„ÅäÂÖÑ„Åï„Çì", "reading": "„Åä„Å´„ÅÑ„Åï„Çì", "meaning": "older brother", "type": "noun"},
            {"japanese": "„ÅäÂßâ„Åï„Çì", "reading": "„Åä„Å≠„Åà„Åï„Çì", "meaning": "older sister", "type": "noun"},
            {"japanese": "Â≠¶Áîü", "reading": "„Åå„Åè„Åõ„ÅÑ", "meaning": "student", "type": "noun"},
            {"japanese": "ÂÖàÁîü", "reading": "„Åõ„Çì„Åõ„ÅÑ", "meaning": "teacher", "type": "noun"},
            {"japanese": "ÁîüÂæí", "reading": "„Åõ„ÅÑ„Å®", "meaning": "pupil", "type": "noun"},
            
            // Body & Health
            {"japanese": "È†≠", "reading": "„ÅÇ„Åü„Åæ", "meaning": "head", "type": "noun"},
            {"japanese": "Êâã", "reading": "„Å¶", "meaning": "hand", "type": "noun"},
            {"japanese": "Ë∂≥", "reading": "„ÅÇ„Åó", "meaning": "foot", "type": "noun"},
            {"japanese": "ÁõÆ", "reading": "„ÇÅ", "meaning": "eye", "type": "noun"},
            {"japanese": "ËÄ≥", "reading": "„Åø„Åø", "meaning": "ear", "type": "noun"},
            {"japanese": "Èºª", "reading": "„ÅØ„Å™", "meaning": "nose", "type": "noun"},
            {"japanese": "Âè£", "reading": "„Åè„Å°", "meaning": "mouth", "type": "noun"},
            {"japanese": "Ê≠Ø", "reading": "„ÅØ", "meaning": "tooth", "type": "noun"},
            {"japanese": "‰Ωì", "reading": "„Åã„Çâ„Å†", "meaning": "body", "type": "noun"},
            {"japanese": "„ÅäËÖπ", "reading": "„Åä„Å™„Åã", "meaning": "stomach", "type": "noun"},
            {"japanese": "ÁóÖÊ∞ó", "reading": "„Å≥„Çá„ÅÜ„Åç", "meaning": "illness", "type": "noun"},
            {"japanese": "ÁóÖÈô¢", "reading": "„Å≥„Çá„ÅÜ„ÅÑ„Çì", "meaning": "hospital", "type": "noun"},
            
            // Time
            {"japanese": "Êúù", "reading": "„ÅÇ„Åï", "meaning": "morning", "type": "noun"},
            {"japanese": "Êòº", "reading": "„Å≤„Çã", "meaning": "noon", "type": "noun"},
            {"japanese": "Êô©", "reading": "„Å∞„Çì", "meaning": "evening", "type": "noun"},
            {"japanese": "Â§ú", "reading": "„Çà„Çã", "meaning": "night", "type": "noun"},
            {"japanese": "‰ªä", "reading": "„ÅÑ„Åæ", "meaning": "now", "type": "noun"},
            {"japanese": "‰ªäÊó•", "reading": "„Åç„Çá„ÅÜ", "meaning": "today", "type": "noun"},
            {"japanese": "ÊòéÊó•", "reading": "„ÅÇ„Åó„Åü", "meaning": "tomorrow", "type": "noun"},
            {"japanese": "Êò®Êó•", "reading": "„Åç„ÅÆ„ÅÜ", "meaning": "yesterday", "type": "noun"},
            {"japanese": "ÊØéÊó•", "reading": "„Åæ„ÅÑ„Å´„Å°", "meaning": "every day", "type": "noun"},
            {"japanese": "ÊØéÊúù", "reading": "„Åæ„ÅÑ„ÅÇ„Åï", "meaning": "every morning", "type": "noun"},
            {"japanese": "ÊØéÊô©", "reading": "„Åæ„ÅÑ„Å∞„Çì", "meaning": "every night", "type": "noun"},
            {"japanese": "‰ªäÈÄ±", "reading": "„Åì„Çì„Åó„ÇÖ„ÅÜ", "meaning": "this week", "type": "noun"},
            {"japanese": "Êù•ÈÄ±", "reading": "„Çâ„ÅÑ„Åó„ÇÖ„ÅÜ", "meaning": "next week", "type": "noun"},
            {"japanese": "‰ªäÊúà", "reading": "„Åì„Çì„Åí„Å§", "meaning": "this month", "type": "noun"},
            {"japanese": "Êù•Êúà", "reading": "„Çâ„ÅÑ„Åí„Å§", "meaning": "next month", "type": "noun"},
            {"japanese": "‰ªäÂπ¥", "reading": "„Åì„Å®„Åó", "meaning": "this year", "type": "noun"},
            {"japanese": "Êù•Âπ¥", "reading": "„Çâ„ÅÑ„Å≠„Çì", "meaning": "next year", "type": "noun"},
            
            // Days of the week
            {"japanese": "ÊúàÊõúÊó•", "reading": "„Åí„Å§„Çà„ÅÜ„Å≥", "meaning": "Monday", "type": "noun"},
            {"japanese": "ÁÅ´ÊõúÊó•", "reading": "„Åã„Çà„ÅÜ„Å≥", "meaning": "Tuesday", "type": "noun"},
            {"japanese": "Ê∞¥ÊõúÊó•", "reading": "„Åô„ÅÑ„Çà„ÅÜ„Å≥", "meaning": "Wednesday", "type": "noun"},
            {"japanese": "Êú®ÊõúÊó•", "reading": "„ÇÇ„Åè„Çà„ÅÜ„Å≥", "meaning": "Thursday", "type": "noun"},
            {"japanese": "ÈáëÊõúÊó•", "reading": "„Åç„Çì„Çà„ÅÜ„Å≥", "meaning": "Friday", "type": "noun"},
            {"japanese": "ÂúüÊõúÊó•", "reading": "„Å©„Çà„ÅÜ„Å≥", "meaning": "Saturday", "type": "noun"},
            {"japanese": "Êó•ÊõúÊó•", "reading": "„Å´„Å°„Çà„ÅÜ„Å≥", "meaning": "Sunday", "type": "noun"},
            
            // Numbers
            {"japanese": "‰∏Ä", "reading": "„ÅÑ„Å°", "meaning": "one", "type": "noun"},
            {"japanese": "‰∫å", "reading": "„Å´", "meaning": "two", "type": "noun"},
            {"japanese": "‰∏â", "reading": "„Åï„Çì", "meaning": "three", "type": "noun"},
            {"japanese": "Âõõ", "reading": "„Åó", "meaning": "four", "type": "noun"},
            {"japanese": "‰∫î", "reading": "„Åî", "meaning": "five", "type": "noun"},
            {"japanese": "ÂÖ≠", "reading": "„Çç„Åè", "meaning": "six", "type": "noun"},
            {"japanese": "‰∏É", "reading": "„Åó„Å°", "meaning": "seven", "type": "noun"},
            {"japanese": "ÂÖ´", "reading": "„ÅØ„Å°", "meaning": "eight", "type": "noun"},
            {"japanese": "‰πù", "reading": "„Åç„ÇÖ„ÅÜ", "meaning": "nine", "type": "noun"},
            {"japanese": "ÂçÅ", "reading": "„Åò„ÇÖ„ÅÜ", "meaning": "ten", "type": "noun"},
            {"japanese": "Áôæ", "reading": "„Å≤„ÇÉ„Åè", "meaning": "hundred", "type": "noun"},
            {"japanese": "ÂçÉ", "reading": "„Åõ„Çì", "meaning": "thousand", "type": "noun"},
            {"japanese": "‰∏á", "reading": "„Åæ„Çì", "meaning": "ten thousand", "type": "noun"},
            
            // Places
            {"japanese": "ÂÆ∂", "reading": "„ÅÑ„Åà", "meaning": "house", "type": "noun"},
            {"japanese": "Â≠¶Ê†°", "reading": "„Åå„Å£„Åì„ÅÜ", "meaning": "school", "type": "noun"},
            {"japanese": "ÊïôÂÆ§", "reading": "„Åç„Çá„ÅÜ„Åó„Å§", "meaning": "classroom", "type": "noun"},
            {"japanese": "Â§ßÂ≠¶", "reading": "„Å†„ÅÑ„Åå„Åè", "meaning": "university", "type": "noun"},
            {"japanese": "Âõ≥Êõ∏È§®", "reading": "„Å®„Åó„Çá„Åã„Çì", "meaning": "library", "type": "noun"},
            {"japanese": "ÂÖ¨Âúí", "reading": "„Åì„ÅÜ„Åà„Çì", "meaning": "park", "type": "noun"},
            {"japanese": "ÈäÄË°å", "reading": "„Åé„Çì„Åì„ÅÜ", "meaning": "bank", "type": "noun"},
            {"japanese": "Â∫ó", "reading": "„Åø„Åõ", "meaning": "store", "type": "noun"},
            {"japanese": "ÈßÖ", "reading": "„Åà„Åç", "meaning": "station", "type": "noun"},
            {"japanese": "ÈÉ®Â±ã", "reading": "„Å∏„ÇÑ", "meaning": "room", "type": "noun"},
            {"japanese": "Âè∞ÊâÄ", "reading": "„Å†„ÅÑ„Å©„Åì„Çç", "meaning": "kitchen", "type": "noun"},
            {"japanese": "Áî∫", "reading": "„Åæ„Å°", "meaning": "town", "type": "noun"},
            
            // Transportation
            {"japanese": "Ëªä", "reading": "„Åè„Çã„Åæ", "meaning": "car", "type": "noun"},
            {"japanese": "ÈõªËªä", "reading": "„Åß„Çì„Åó„ÇÉ", "meaning": "train", "type": "noun"},
            {"japanese": "„Éê„Çπ", "reading": "„Å∞„Åô", "meaning": "bus", "type": "noun"},
            {"japanese": "È£õË°åÊ©ü", "reading": "„Å≤„Åì„ÅÜ„Åç", "meaning": "airplane", "type": "noun"},
            {"japanese": "„Çø„ÇØ„Ç∑„Éº", "reading": "„Åü„Åè„Åó„Éº", "meaning": "taxi", "type": "noun"},
            {"japanese": "Ëá™Ëª¢Ëªä", "reading": "„Åò„Å¶„Çì„Åó„ÇÉ", "meaning": "bicycle", "type": "noun"},
            
            // Food & Drink
            {"japanese": "„ÅîÈ£Ø", "reading": "„Åî„ÅØ„Çì", "meaning": "rice/meal", "type": "noun"},
            {"japanese": "Êúù„ÅîÈ£Ø", "reading": "„ÅÇ„Åï„Åî„ÅØ„Çì", "meaning": "breakfast", "type": "noun"},
            {"japanese": "Êòº„ÅîÈ£Ø", "reading": "„Å≤„Çã„Åî„ÅØ„Çì", "meaning": "lunch", "type": "noun"},
            {"japanese": "Êô©„ÅîÈ£Ø", "reading": "„Å∞„Çì„Åî„ÅØ„Çì", "meaning": "dinner", "type": "noun"},
            {"japanese": "„Éë„É≥", "reading": "„Å±„Çì", "meaning": "bread", "type": "noun"},
            {"japanese": "Âçµ", "reading": "„Åü„Åæ„Åî", "meaning": "egg", "type": "noun"},
            {"japanese": "ËÇâ", "reading": "„Å´„Åè", "meaning": "meat", "type": "noun"},
            {"japanese": "ÈáéËèú", "reading": "„ÇÑ„Åï„ÅÑ", "meaning": "vegetable", "type": "noun"},
            {"japanese": "ÊûúÁâ©", "reading": "„Åè„Å†„ÇÇ„ÅÆ", "meaning": "fruit", "type": "noun"},
            {"japanese": "Ê∞¥", "reading": "„Åø„Åö", "meaning": "water", "type": "noun"},
            {"japanese": "„ÅäËå∂", "reading": "„Åä„Å°„ÇÉ", "meaning": "tea", "type": "noun"},
            {"japanese": "„Ç≥„Éº„Éí„Éº", "reading": "„Åì„Éº„Å≤„Éº", "meaning": "coffee", "type": "noun"},
            {"japanese": "Áâõ‰π≥", "reading": "„Åé„ÇÖ„ÅÜ„Å´„ÇÖ„ÅÜ", "meaning": "milk", "type": "noun"},
            {"japanese": "„Éì„Éº„É´", "reading": "„Å≥„Éº„Çã", "meaning": "beer", "type": "noun"},
            
            // Nature & Weather
            {"japanese": "Â±±", "reading": "„ÇÑ„Åæ", "meaning": "mountain", "type": "noun"},
            {"japanese": "Â∑ù", "reading": "„Åã„Çè", "meaning": "river", "type": "noun"},
            {"japanese": "Êµ∑", "reading": "„ÅÜ„Åø", "meaning": "sea", "type": "noun"},
            {"japanese": "Èõ™", "reading": "„ÇÜ„Åç", "meaning": "snow", "type": "noun"},
            {"japanese": "Èõ®", "reading": "„ÅÇ„ÇÅ", "meaning": "rain", "type": "noun"},
            {"japanese": "È¢®", "reading": "„Åã„Åú", "meaning": "wind", "type": "noun"},
            {"japanese": "Á©∫", "reading": "„Åù„Çâ", "meaning": "sky", "type": "noun"},
            {"japanese": "Â§©Ê∞ó", "reading": "„Å¶„Çì„Åç", "meaning": "weather", "type": "noun"},
            {"japanese": "Êò•", "reading": "„ÅØ„Çã", "meaning": "spring", "type": "noun"},
            {"japanese": "Â§è", "reading": "„Å™„Å§", "meaning": "summer", "type": "noun"},
            {"japanese": "Áßã", "reading": "„ÅÇ„Åç", "meaning": "autumn", "type": "noun"},
            {"japanese": "ÂÜ¨", "reading": "„Åµ„ÇÜ", "meaning": "winter", "type": "noun"},
            
            // Animals
            {"japanese": "Áä¨", "reading": "„ÅÑ„Å¨", "meaning": "dog", "type": "noun"},
            {"japanese": "Áå´", "reading": "„Å≠„Åì", "meaning": "cat", "type": "noun"},
            {"japanese": "È≥•", "reading": "„Å®„Çä", "meaning": "bird", "type": "noun"},
            {"japanese": "È≠ö", "reading": "„Åï„Åã„Å™", "meaning": "fish", "type": "noun"},
            {"japanese": "ÂãïÁâ©", "reading": "„Å©„ÅÜ„Å∂„Å§", "meaning": "animal", "type": "noun"},
            
            // Colors
            {"japanese": "Ëµ§", "reading": "„ÅÇ„Åã", "meaning": "red", "type": "noun"},
            {"japanese": "Èùí", "reading": "„ÅÇ„Åä", "meaning": "blue", "type": "noun"},
            {"japanese": "ÁôΩ", "reading": "„Åó„Çç", "meaning": "white", "type": "noun"},
            {"japanese": "Èªí", "reading": "„Åè„Çç", "meaning": "black", "type": "noun"},
            {"japanese": "ÈªÑËâ≤", "reading": "„Åç„ÅÑ„Çç", "meaning": "yellow", "type": "noun"},
            {"japanese": "Á∑ë", "reading": "„Åø„Å©„Çä", "meaning": "green", "type": "noun"},
            
            // Objects
            {"japanese": "Êú¨", "reading": "„Åª„Çì", "meaning": "book", "type": "noun"},
            {"japanese": "„Éö„É≥", "reading": "„Å∫„Çì", "meaning": "pen", "type": "noun"},
            {"japanese": "ÈâõÁ≠Ü", "reading": "„Åà„Çì„Å¥„Å§", "meaning": "pencil", "type": "noun"},
            {"japanese": "Á¥ô", "reading": "„Åã„Åø", "meaning": "paper", "type": "noun"},
            {"japanese": "Êú∫", "reading": "„Å§„Åè„Åà", "meaning": "desk", "type": "noun"},
            {"japanese": "Ê§ÖÂ≠ê", "reading": "„ÅÑ„Åô", "meaning": "chair", "type": "noun"},
            {"japanese": "ÊôÇË®à", "reading": "„Å®„Åë„ÅÑ", "meaning": "clock", "type": "noun"},
            {"japanese": "ÂÇò", "reading": "„Åã„Åï", "meaning": "umbrella", "type": "noun"},
            {"japanese": "ÈûÑ", "reading": "„Åã„Å∞„Çì", "meaning": "bag", "type": "noun"},
            {"japanese": "Èù¥", "reading": "„Åè„Å§", "meaning": "shoes", "type": "noun"},
            {"japanese": "Êúç", "reading": "„Åµ„Åè", "meaning": "clothes", "type": "noun"},
            {"japanese": "Â∏ΩÂ≠ê", "reading": "„Åº„ÅÜ„Åó", "meaning": "hat", "type": "noun"},
            {"japanese": "ÁúºÈè°", "reading": "„ÇÅ„Åå„Å≠", "meaning": "glasses", "type": "noun"},
            
            // Activities
            {"japanese": "ÂãâÂº∑", "reading": "„Åπ„Çì„Åç„Çá„ÅÜ", "meaning": "study", "type": "noun"},
            {"japanese": "‰ªï‰∫ã", "reading": "„Åó„Åî„Å®", "meaning": "work", "type": "noun"},
            {"japanese": "Ë≤∑„ÅÑÁâ©", "reading": "„Åã„ÅÑ„ÇÇ„ÅÆ", "meaning": "shopping", "type": "noun"},
            {"japanese": "ÊñôÁêÜ", "reading": "„Çä„Çá„ÅÜ„Çä", "meaning": "cooking", "type": "noun"},
            {"japanese": "ÊéÉÈô§", "reading": "„Åù„ÅÜ„Åò", "meaning": "cleaning", "type": "noun"},
            {"japanese": "Ê¥óÊøØ", "reading": "„Åõ„Çì„Åü„Åè", "meaning": "laundry", "type": "noun"},
            {"japanese": "ÊóÖË°å", "reading": "„Çä„Çá„Åì„ÅÜ", "meaning": "travel", "type": "noun"},
            {"japanese": "Êï£Ê≠©", "reading": "„Åï„Çì„ÅΩ", "meaning": "walk", "type": "noun"},
            {"japanese": "ÈÅãÂãï", "reading": "„ÅÜ„Çì„Å©„ÅÜ", "meaning": "exercise", "type": "noun"},
            {"japanese": "„Çπ„Éù„Éº„ÉÑ", "reading": "„Åô„ÅΩ„Éº„Å§", "meaning": "sports", "type": "noun"},
            {"japanese": "Èü≥Ê•Ω", "reading": "„Åä„Çì„Åå„Åè", "meaning": "music", "type": "noun"},
            {"japanese": "Êò†Áîª", "reading": "„Åà„ÅÑ„Åå", "meaning": "movie", "type": "noun"},
            {"japanese": "ÂÜôÁúü", "reading": "„Åó„ÇÉ„Åó„Çì", "meaning": "photograph", "type": "noun"},
            
            // i-adjectives
            {"japanese": "Êñ∞„Åó„ÅÑ", "reading": "„ÅÇ„Åü„Çâ„Åó„ÅÑ", "meaning": "new", "type": "i-adjective"},
            {"japanese": "Âè§„ÅÑ", "reading": "„Åµ„Çã„ÅÑ", "meaning": "old", "type": "i-adjective"},
            {"japanese": "Â§ß„Åç„ÅÑ", "reading": "„Åä„Åä„Åç„ÅÑ", "meaning": "big", "type": "i-adjective"},
            {"japanese": "Â∞è„Åï„ÅÑ", "reading": "„Å°„ÅÑ„Åï„ÅÑ", "meaning": "small", "type": "i-adjective"},
            {"japanese": "È´ò„ÅÑ", "reading": "„Åü„Åã„ÅÑ", "meaning": "expensive/tall", "type": "i-adjective"},
            {"japanese": "ÂÆâ„ÅÑ", "reading": "„ÇÑ„Åô„ÅÑ", "meaning": "cheap", "type": "i-adjective"},
            {"japanese": "ËâØ„ÅÑ", "reading": "„ÅÑ„ÅÑ", "meaning": "good", "type": "i-adjective"},
            {"japanese": "ÊÇ™„ÅÑ", "reading": "„Çè„Çã„ÅÑ", "meaning": "bad", "type": "i-adjective"},
            {"japanese": "ÁæéÂë≥„Åó„ÅÑ", "reading": "„Åä„ÅÑ„Åó„ÅÑ", "meaning": "delicious", "type": "i-adjective"},
            {"japanese": "Êöë„ÅÑ", "reading": "„ÅÇ„Å§„ÅÑ", "meaning": "hot", "type": "i-adjective"},
            {"japanese": "ÂØí„ÅÑ", "reading": "„Åï„ÇÄ„ÅÑ", "meaning": "cold", "type": "i-adjective"},
            {"japanese": "Êöñ„Åã„ÅÑ", "reading": "„ÅÇ„Åü„Åü„Åã„ÅÑ", "meaning": "warm", "type": "i-adjective"},
            {"japanese": "Ê∂º„Åó„ÅÑ", "reading": "„Åô„Åö„Åó„ÅÑ", "meaning": "cool", "type": "i-adjective"},
            {"japanese": "ÁÜ±„ÅÑ", "reading": "„ÅÇ„Å§„ÅÑ", "meaning": "hot (to touch)", "type": "i-adjective"},
            {"japanese": "ÂÜ∑„Åü„ÅÑ", "reading": "„Å§„ÇÅ„Åü„ÅÑ", "meaning": "cold (to touch)", "type": "i-adjective"},
            {"japanese": "Êòé„Çã„ÅÑ", "reading": "„ÅÇ„Åã„Çã„ÅÑ", "meaning": "bright", "type": "i-adjective"},
            {"japanese": "Êöó„ÅÑ", "reading": "„Åè„Çâ„ÅÑ", "meaning": "dark", "type": "i-adjective"},
            {"japanese": "Èáç„ÅÑ", "reading": "„Åä„ÇÇ„ÅÑ", "meaning": "heavy", "type": "i-adjective"},
            {"japanese": "ËªΩ„ÅÑ", "reading": "„Åã„Çã„ÅÑ", "meaning": "light", "type": "i-adjective"},
            {"japanese": "Âº∑„ÅÑ", "reading": "„Å§„Çà„ÅÑ", "meaning": "strong", "type": "i-adjective"},
            {"japanese": "Âº±„ÅÑ", "reading": "„Çà„Çè„ÅÑ", "meaning": "weak", "type": "i-adjective"},
            {"japanese": "Èï∑„ÅÑ", "reading": "„Å™„Åå„ÅÑ", "meaning": "long", "type": "i-adjective"},
            {"japanese": "Áü≠„ÅÑ", "reading": "„Åø„Åò„Åã„ÅÑ", "meaning": "short", "type": "i-adjective"},
            {"japanese": "Â∫É„ÅÑ", "reading": "„Å≤„Çç„ÅÑ", "meaning": "wide", "type": "i-adjective"},
            {"japanese": "Áã≠„ÅÑ", "reading": "„Åõ„Åæ„ÅÑ", "meaning": "narrow", "type": "i-adjective"},
            {"japanese": "Â§ö„ÅÑ", "reading": "„Åä„Åä„ÅÑ", "meaning": "many", "type": "i-adjective"},
            {"japanese": "Â∞ë„Å™„ÅÑ", "reading": "„Åô„Åè„Å™„ÅÑ", "meaning": "few", "type": "i-adjective"},
            {"japanese": "Êó©„ÅÑ", "reading": "„ÅØ„ÇÑ„ÅÑ", "meaning": "early", "type": "i-adjective"},
            {"japanese": "ÈÅÖ„ÅÑ", "reading": "„Åä„Åù„ÅÑ", "meaning": "late", "type": "i-adjective"},
            {"japanese": "ÈÄü„ÅÑ", "reading": "„ÅØ„ÇÑ„ÅÑ", "meaning": "fast", "type": "i-adjective"},
            {"japanese": "ÈÅ†„ÅÑ", "reading": "„Å®„Åä„ÅÑ", "meaning": "far", "type": "i-adjective"},
            {"japanese": "Ëøë„ÅÑ", "reading": "„Å°„Åã„ÅÑ", "meaning": "near", "type": "i-adjective"},
            {"japanese": "È´ò„ÅÑ", "reading": "„Åü„Åã„ÅÑ", "meaning": "high", "type": "i-adjective"},
            {"japanese": "‰Ωé„ÅÑ", "reading": "„Å≤„Åè„ÅÑ", "meaning": "low", "type": "i-adjective"},
            {"japanese": "Èõ£„Åó„ÅÑ", "reading": "„ÇÄ„Åö„Åã„Åó„ÅÑ", "meaning": "difficult", "type": "i-adjective"},
            {"japanese": "Êòì„Åó„ÅÑ", "reading": "„ÇÑ„Åï„Åó„ÅÑ", "meaning": "easy", "type": "i-adjective"},
            {"japanese": "Èù¢ÁôΩ„ÅÑ", "reading": "„Åä„ÇÇ„Åó„Çç„ÅÑ", "meaning": "interesting", "type": "i-adjective"},
            {"japanese": "„Å§„Åæ„Çâ„Å™„ÅÑ", "reading": "„Å§„Åæ„Çâ„Å™„ÅÑ", "meaning": "boring", "type": "i-adjective"},
            {"japanese": "Ê•Ω„Åó„ÅÑ", "reading": "„Åü„ÅÆ„Åó„ÅÑ", "meaning": "fun", "type": "i-adjective"},
            {"japanese": "Âøô„Åó„ÅÑ", "reading": "„ÅÑ„Åù„Åå„Åó„ÅÑ", "meaning": "busy", "type": "i-adjective"},
            {"japanese": "Áóõ„ÅÑ", "reading": "„ÅÑ„Åü„ÅÑ", "meaning": "painful", "type": "i-adjective"},
            {"japanese": "Áú†„ÅÑ", "reading": "„Å≠„ÇÄ„ÅÑ", "meaning": "sleepy", "type": "i-adjective"},
            {"japanese": "ÊÄñ„ÅÑ", "reading": "„Åì„Çè„ÅÑ", "meaning": "scary", "type": "i-adjective"},
            {"japanese": "Âç±„Å™„ÅÑ", "reading": "„ÅÇ„Å∂„Å™„ÅÑ", "meaning": "dangerous", "type": "i-adjective"},
            {"japanese": "„ÅÜ„Çã„Åï„ÅÑ", "reading": "„ÅÜ„Çã„Åï„ÅÑ", "meaning": "noisy", "type": "i-adjective"},
            {"japanese": "Ëã•„ÅÑ", "reading": "„Çè„Åã„ÅÑ", "meaning": "young", "type": "i-adjective"},
            {"japanese": "Ëµ§„ÅÑ", "reading": "„ÅÇ„Åã„ÅÑ", "meaning": "red", "type": "i-adjective"},
            {"japanese": "Èùí„ÅÑ", "reading": "„ÅÇ„Åä„ÅÑ", "meaning": "blue", "type": "i-adjective"},
            {"japanese": "ÁôΩ„ÅÑ", "reading": "„Åó„Çç„ÅÑ", "meaning": "white", "type": "i-adjective"},
            {"japanese": "Èªí„ÅÑ", "reading": "„Åè„Çç„ÅÑ", "meaning": "black", "type": "i-adjective"},
            {"japanese": "ÈªÑËâ≤„ÅÑ", "reading": "„Åç„ÅÑ„Çç„ÅÑ", "meaning": "yellow", "type": "i-adjective"},
            {"japanese": "ÂèØÊÑõ„ÅÑ", "reading": "„Åã„Çè„ÅÑ„ÅÑ", "meaning": "cute", "type": "i-adjective"},
            {"japanese": "Áæé„Åó„ÅÑ", "reading": "„ÅÜ„Å§„Åè„Åó„ÅÑ", "meaning": "beautiful", "type": "i-adjective"},
            {"japanese": "Ê±ö„ÅÑ", "reading": "„Åç„Åü„Å™„ÅÑ", "meaning": "dirty", "type": "i-adjective"},
            {"japanese": "Áîò„ÅÑ", "reading": "„ÅÇ„Åæ„ÅÑ", "meaning": "sweet", "type": "i-adjective"},
            {"japanese": "Ëæõ„ÅÑ", "reading": "„Åã„Çâ„ÅÑ", "meaning": "spicy", "type": "i-adjective"},
            {"japanese": "ÈÖ∏„Å£„Å±„ÅÑ", "reading": "„Åô„Å£„Å±„ÅÑ", "meaning": "sour", "type": "i-adjective"},
            {"japanese": "Ëã¶„ÅÑ", "reading": "„Å´„Åå„ÅÑ", "meaning": "bitter", "type": "i-adjective"},
            
            // na-adjectives
            {"japanese": "ÂÖÉÊ∞ó", "reading": "„Åí„Çì„Åç", "meaning": "healthy/energetic", "type": "na-adjective"},
            {"japanese": "ÊúâÂêç", "reading": "„ÇÜ„ÅÜ„ÇÅ„ÅÑ", "meaning": "famous", "type": "na-adjective"},
            {"japanese": "‰æøÂà©", "reading": "„Åπ„Çì„Çä", "meaning": "convenient", "type": "na-adjective"},
            {"japanese": "‰∏ç‰æø", "reading": "„Åµ„Åπ„Çì", "meaning": "inconvenient", "type": "na-adjective"},
            {"japanese": "Á∂∫È∫ó", "reading": "„Åç„Çå„ÅÑ", "meaning": "beautiful/clean", "type": "na-adjective"},
            {"japanese": "Èùô„Åã", "reading": "„Åó„Åö„Åã", "meaning": "quiet", "type": "na-adjective"},
            {"japanese": "Ë≥ë„ÇÑ„Åã", "reading": "„Å´„Åé„ÇÑ„Åã", "meaning": "lively", "type": "na-adjective"},
            {"japanese": "Ë¶™Âàá", "reading": "„Åó„Çì„Åõ„Å§", "meaning": "kind", "type": "na-adjective"},
            {"japanese": "‰∏ÅÂØß", "reading": "„Å¶„ÅÑ„Å≠„ÅÑ", "meaning": "polite", "type": "na-adjective"},
            {"japanese": "Á∞°Âçò", "reading": "„Åã„Çì„Åü„Çì", "meaning": "simple", "type": "na-adjective"},
            {"japanese": "Â§ßÂ§â", "reading": "„Åü„ÅÑ„Å∏„Çì", "meaning": "tough/hard", "type": "na-adjective"},
            {"japanese": "Â§ß‰∏àÂ§´", "reading": "„Å†„ÅÑ„Åò„Çá„ÅÜ„Å∂", "meaning": "OK/alright", "type": "na-adjective"},
            {"japanese": "ÂÆâÂÖ®", "reading": "„ÅÇ„Çì„Åú„Çì", "meaning": "safe", "type": "na-adjective"},
            {"japanese": "Âç±Èô∫", "reading": "„Åç„Åë„Çì", "meaning": "dangerous", "type": "na-adjective"},
            {"japanese": "Ëá™Áî±", "reading": "„Åò„ÇÜ„ÅÜ", "meaning": "free", "type": "na-adjective"},
            {"japanese": "Â§ßÂàá", "reading": "„Åü„ÅÑ„Åõ„Å§", "meaning": "important", "type": "na-adjective"},
            {"japanese": "ÂøÖË¶Å", "reading": "„Å≤„Å§„Çà„ÅÜ", "meaning": "necessary", "type": "na-adjective"},
            {"japanese": "ÁâπÂà•", "reading": "„Å®„Åè„Åπ„Å§", "meaning": "special", "type": "na-adjective"},
            {"japanese": "ÊôÆÈÄö", "reading": "„Åµ„Å§„ÅÜ", "meaning": "normal", "type": "na-adjective"},
            {"japanese": "Âêå„Åò", "reading": "„Åä„Å™„Åò", "meaning": "same", "type": "na-adjective"},
            {"japanese": "Â•Ω„Åç", "reading": "„Åô„Åç", "meaning": "like", "type": "na-adjective"},
            {"japanese": "Â´å„ÅÑ", "reading": "„Åç„Çâ„ÅÑ", "meaning": "dislike", "type": "na-adjective"},
            {"japanese": "‰∏äÊâã", "reading": "„Åò„Çá„ÅÜ„Åö", "meaning": "skillful", "type": "na-adjective"},
            {"japanese": "‰∏ãÊâã", "reading": "„Å∏„Åü", "meaning": "unskillful", "type": "na-adjective"},
            {"japanese": "ÂæóÊÑè", "reading": "„Å®„Åè„ÅÑ", "meaning": "good at", "type": "na-adjective"},
            {"japanese": "Ëã¶Êâã", "reading": "„Å´„Åå„Å¶", "meaning": "bad at", "type": "na-adjective"},
            {"japanese": "Êöá", "reading": "„Å≤„Åæ", "meaning": "free time", "type": "na-adjective"},
            {"japanese": "Ê•Ω", "reading": "„Çâ„Åè", "meaning": "easy/comfortable", "type": "na-adjective"},
            {"japanese": "Êñ∞ÈÆÆ", "reading": "„Åó„Çì„Åõ„Çì", "meaning": "fresh", "type": "na-adjective"},
            {"japanese": "ÂÆåÁíß", "reading": "„Åã„Çì„Å∫„Åç", "meaning": "perfect", "type": "na-adjective"},
            {"japanese": "ÊúÄÈ´ò", "reading": "„Åï„ÅÑ„Åì„ÅÜ", "meaning": "the best", "type": "na-adjective"},
            {"japanese": "Âπ∏„Åõ", "reading": "„Åó„ÅÇ„Çè„Åõ", "meaning": "happy", "type": "na-adjective"},
            {"japanese": "ÂøÉÈÖç", "reading": "„Åó„Çì„Å±„ÅÑ", "meaning": "worried", "type": "na-adjective"},
            {"japanese": "ÂÆâÂøÉ", "reading": "„ÅÇ„Çì„Åó„Çì", "meaning": "relieved", "type": "na-adjective"},
            {"japanese": "ÊÆãÂøµ", "reading": "„Åñ„Çì„Å≠„Çì", "meaning": "disappointing", "type": "na-adjective"},
            {"japanese": "Á¥†Êô¥„Çâ„Åó„ÅÑ", "reading": "„Åô„Å∞„Çâ„Åó„ÅÑ", "meaning": "wonderful", "type": "na-adjective"},
            {"japanese": "Á´ãÊ¥æ", "reading": "„Çä„Å£„Å±", "meaning": "splendid", "type": "na-adjective"},
            {"japanese": "ÁúüÈù¢ÁõÆ", "reading": "„Åæ„Åò„ÇÅ", "meaning": "serious", "type": "na-adjective"}
        ];

        let currentMode = 'mixed';
        let currentCardIndex = 0;
        let isFlipped = false;
        let cardsStudied = new Set();
        let flipCount = 0;
        let currentDeck = [...allFlashcards];

        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        function setMode(mode) {
            currentMode = mode;
            document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            updateCard();
        }

        function updateCard() {
            const card = currentDeck[currentCardIndex];
            const promptText = document.getElementById('promptText');
            const japaneseWord = document.getElementById('japaneseWord');
            const reading = document.getElementById('reading');
            const meaning = document.getElementById('meaning');

            // Reset display
            promptText.textContent = '';
            meaning.style.display = 'none';
            japaneseWord.style.fontSize = '42px';
            isFlipped = false;
            document.getElementById('flashcard').classList.remove('flipped');

            switch (currentMode) {
                case 'mixed':
                    japaneseWord.textContent = card.japanese;
                    reading.textContent = card.reading;
                    meaning.textContent = card.meaning;
                    break;
                case 'jp-to-en':
                    japaneseWord.textContent = card.japanese;
                    reading.textContent = '';
                    meaning.textContent = card.meaning + ' (' + card.reading + ')';
                    break;
                case 'en-to-jp':
                    promptText.textContent = 'What is the Japanese for:';
                    japaneseWord.textContent = card.meaning;
                    japaneseWord.style.fontSize = '28px';
                    reading.textContent = '';
                    meaning.textContent = card.japanese + ' (' + card.reading + ')';
                    break;
                case 'reading':
                    promptText.textContent = 'What does this reading mean?';
                    japaneseWord.textContent = card.reading;
                    reading.textContent = '';
                    meaning.textContent = card.japanese + ' - ' + card.meaning;
                    break;
            }

            // Update progress
            document.getElementById('cardCounter').textContent = 
                `Card ${currentCardIndex + 1} of ${currentDeck.length}`;
            document.getElementById('progressBar').style.width = 
                ((currentCardIndex + 1) / currentDeck.length) * 100 + '%';

            cardsStudied.add(currentCardIndex);
            updateStats();
        }

        function flipCard() {
            const meaning = document.getElementById('meaning');
            const flashcard = document.getElementById('flashcard');
            
            if (isFlipped) {
                meaning.style.display = 'none';
                flashcard.classList.remove('flipped');
            } else {
                meaning.style.display = 'block';
                flashcard.classList.add('flipped');
                flipCount++;
            }
            isFlipped = !isFlipped;
            updateStats();
        }

        function nextCard() {
            if (currentCardIndex < currentDeck.length - 1) {
                currentCardIndex++;
                updateCard();
            }
        }

        function previousCard() {
            if (currentCardIndex > 0) {
                currentCardIndex--;
                updateCard();
            }
        }

        function shuffleCards() {
            currentDeck = shuffleArray(allFlashcards);
            currentCardIndex = 0;
            cardsStudied.clear();
            updateCard();
        }

        function resetProgress() {
            currentCardIndex = 0;
            cardsStudied.clear();
            flipCount = 0;
            updateCard();
        }

        function toggleStats() {
            document.getElementById('stats').classList.toggle('show');
        }

        // Feedback System Functions
        function showFeedbackForm() {
            document.getElementById('feedbackModal').style.display = 'block';
            setupStarRating();
        }

        function hideFeedbackForm() {
            document.getElementById('feedbackModal').style.display = 'none';
        }

        function setupStarRating() {
            const starRating = document.getElementById('starRating');
            const stars = ['‚≠ê', '‚≠ê', '‚≠ê', '‚≠ê', '‚≠ê'];
            let currentRating = 5;
            
            function updateStars() {
                starRating.innerHTML = stars.map((star, index) => {
                    return `<span style="color: ${index < currentRating ? '#ffb300' : '#ddd'}; cursor: pointer;" onclick="setRating(${index + 1})">${star}</span>`;
                }).join('');
            }
            
            window.setRating = function(rating) {
                currentRating = rating;
                document.getElementById('ratingValue').value = rating;
                updateStars();
            };
            
            updateStars();
        }

        function submitFeedback(event) {
            event.preventDefault();
            
            // Show success message
            document.getElementById('successMessage').style.display = 'block';
            setTimeout(() => {
                document.getElementById('successMessage').style.display = 'none';
            }, 3000);
            
            // Hide modal
            hideFeedbackForm();
            
            // Submit the form
            const form = event.target;
            fetch('/', {
                method: 'POST',
                headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                body: new URLSearchParams(new FormData(form)).toString()
            }).catch(error => console.log('Feedback submission error:', error));
            
            // Reset form
            form.reset();
        }

        // Close modal when clicking outside
        document.addEventListener('click', function(event) {
            const modal = document.getElementById('feedbackModal');
            if (event.target === modal) {
                hideFeedbackForm();
            }
        });

        function updateStats() {
            document.getElementById('cardsStudied').textContent = cardsStudied.size;
            document.getElementById('timesFlipped').textContent = flipCount;
            document.getElementById('progressPercent').textContent = 
                Math.round((cardsStudied.size / currentDeck.length) * 100) + '%';
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', function(event) {
            switch(event.key) {
                case ' ':
                case 'Enter':
                    event.preventDefault();
                    flipCard();
                    break;
                case 'ArrowLeft':
                    event.preventDefault();
                    previousCard();
                    break;
                case 'ArrowRight':
                    event.preventDefault();
                    nextCard();
                    break;
            }
        });

        // Service Worker Registration for Offline Support
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js')
                    .then(function(registration) {
                        console.log('Service Worker registered successfully:', registration.scope);
                    })
                    .catch(function(error) {
                        console.log('Service Worker registration failed:', error);
                    });
            });
        }

        // Progressive Web App Install Prompt
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            showInstallButton();
        });

        function showInstallButton() {
            // Create install button if it doesn't exist
            if (!document.getElementById('installBtn')) {
                const installBtn = document.createElement('button');
                installBtn.id = 'installBtn';
                installBtn.textContent = 'üì± Install App';
                installBtn.className = 'btn btn-secondary';
                installBtn.style.marginTop = '10px';
                installBtn.onclick = installApp;
                
                const lastControlsDiv = document.querySelectorAll('.controls')[1];
                lastControlsDiv.appendChild(installBtn);
            }
        }

        function installApp() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('User accepted the install prompt');
                    }
                    deferredPrompt = null;
                    document.getElementById('installBtn').style.display = 'none';
                });
            }
        }

        // Local Storage for Progress Persistence (Offline)
        function saveProgress() {
            const progress = {
                currentCardIndex,
                cardsStudied: Array.from(cardsStudied),
                flipCount,
                currentMode,
                lastStudied: new Date().toISOString()
            };
            localStorage.setItem('jlptN5Progress', JSON.stringify(progress));
        }

        function loadProgress() {
            try {
                const saved = localStorage.getItem('jlptN5Progress');
                if (saved) {
                    const progress = JSON.parse(saved);
                    currentCardIndex = progress.currentCardIndex || 0;
                    cardsStudied = new Set(progress.cardsStudied || []);
                    flipCount = progress.flipCount || 0;
                    currentMode = progress.currentMode || 'mixed';
                    
                    // Update mode button
                    document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
                    const targetBtn = document.querySelector(`[onclick*="${currentMode}"]`);
                    if (targetBtn) targetBtn.classList.add('active');
                    
                    console.log('Progress loaded from offline storage');
                    return true;
                }
            } catch (error) {
                console.log('Could not load progress:', error);
            }
            return false;
        }

        // Enhanced update functions with offline save
        function updateCardWithSave() {
            updateCard();
            saveProgress();
        }

        function flipCardWithSave() {
            flipCard();
            saveProgress();
        }

        function nextCardWithSave() {
            nextCard();
            saveProgress();
        }

        function previousCardWithSave() {
            previousCard();
            saveProgress();
        }

        function setModeWithSave(mode) {
            setMode(mode);
            saveProgress();
        }

        // Initialize the application
        shuffleCards();
        
        // Try to load previous progress
        const progressLoaded = loadProgress();
        if (progressLoaded) {
            updateCard();
        }
        
        console.log('JLPT N5 Flashcards loaded successfully with', allFlashcards.length, 'cards!');
        console.log('Offline support enabled - app works without internet connection');
    </script>

    <!-- Inline Service Worker for Offline Support -->
    <script>
        // Create service worker content
        const swContent = `
const CACHE_NAME = 'jlpt-n5-flashcards-v1';
const urlsToCache = [
    '/',
    '/index.html'
];

// Install event - cache resources
self.addEventListener('install', function(event) {
    event.waitUntil(
        caches.open(CACHE_NAME)
            .then(function(cache) {
                return cache.addAll(urlsToCache);
            })
    );
});

// Fetch event - serve from cache when offline
self.addEventListener('fetch', function(event) {
    event.respondWith(
        caches.match(event.request)
            .then(function(response) {
                // Return cached version or fetch from network
                return response || fetch(event.request);
            }
        )
    );
});

// Activate event - clean up old caches
self.addEventListener('activate', function(event) {
    event.waitUntil(
        caches.keys().then(function(cacheNames) {
            return Promise.all(
                cacheNames.map(function(cacheName) {
                    if (cacheName !== CACHE_NAME) {
                        return caches.delete(cacheName);
                    }
                })
            );
        })
    );
});
`;

        // Register service worker with inline content
        if ('serviceWorker' in navigator) {
            const blob = new Blob([swContent], { type: 'application/javascript' });
            const swUrl = URL.createObjectURL(blob);
            
            navigator.serviceWorker.register(swUrl)
                .then(registration => {
                    console.log('Service Worker registered for offline support');
                })
                .catch(error => {
                    console.log('Service Worker registration failed:', error);
                });
        }
    </script>
</body>
</html>
